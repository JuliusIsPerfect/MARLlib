{"episode_reward_max": 164.91356221013916, "episode_reward_min": 24.91198223283981, "episode_reward_mean": 87.8878247644182, "episode_len_mean": 207.16666666666666, "episode_media": {}, "episodes_this_iter": 12, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [85.52604742973261, 74.32881534281108, 123.00724534703993, 87.56172885932136, 62.75245348000842, 164.91356221013916, 57.26511589040773, 142.0714879741194, 24.91198223283981, 92.60116389587637, 71.14132119892655, 68.57297331179578], "episode_lengths": [166, 269, 185, 227, 247, 167, 187, 176, 273, 140, 185, 264]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.099145398695439, "mean_inference_ms": 1.8815855849756276, "mean_action_processing_ms": 0.094490296929582, "mean_env_wait_ms": 56.69079125729582, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 10400, "timesteps_this_iter": 0, "agent_timesteps_total": 10400, "timers": {"sample_time_ms": 155693.908, "sample_throughput": 66.798, "load_time_ms": 0.998, "load_throughput": 10420631.056, "learn_time_ms": 2678.734, "learn_throughput": 3882.431, "update_time_ms": 0.997}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.2, "cur_lr": 0.0005, "total_loss": 312.81378784179685, "policy_loss": 0.012209287995938211, "vf_loss": 312.9448974609375, "vf_explained_var": 0.002355659008026123, "kl": 0.010001317103966798, "entropy": 14.531973838806152, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 10400, "num_agent_steps_sampled": 10400, "num_steps_trained": 10400, "num_agent_steps_trained": 10400}, "done": false, "episodes_total": 12, "training_iteration": 1, "trial_id": "370a4_00000", "experiment_id": "1495134c1e64496d851df0205982c5a3", "date": "2024-01-04_09-35-54", "timestamp": 1704332154, "time_this_iter_s": 158.20997548103333, "time_total_s": 158.20997548103333, "pid": 13208, "hostname": "DESKTOP-CC49RT1", "node_ip": "127.0.0.1", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 10000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "aircombat", "env_args": {"map_name": "MultipleCombat_4v4/NoWeapon/vsBaseline"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": false, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 10, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box(-10.0, 10.0, (51,), float32))", "space_act": "MultiDiscrete([41 41 41 30])", "num_agents": 4, "episode_limit": 1000, "policy_mapping_info": {"MultipleCombat_2v2/NoWeapon/Selfplay": {"description": "aircombat AI vs AI", "team_prefix": ["teamA_", "teamB_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "MultipleCombat_2v2/NoWeapon/vsBaseline": {"description": "aircombat AI vs Bot", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "MultipleCombat_4v4/NoWeapon/vsBaseline": {"description": "aircombat AI vs Bot", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["agent_0", "agent_1", "agent_2", "agent_3"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "aircombat_MultipleCombat_4v4/NoWeapon/vsBaseline", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x000002124579FF70>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 10000, "shuffle_sequences": true, "num_sgd_iter": 5, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 158.20997548103333, "timesteps_since_restore": 0, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 41.76026785714286, "ram_util_percent": 43.83705357142857}}
{"episode_reward_max": 164.91356221013916, "episode_reward_min": 24.91198223283981, "episode_reward_mean": 72.96382582048409, "episode_len_mean": 213.20833333333334, "episode_media": {}, "episodes_this_iter": 12, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [85.52604742973261, 74.32881534281108, 123.00724534703993, 87.56172885932136, 62.75245348000842, 164.91356221013916, 57.26511589040773, 142.0714879741194, 24.91198223283981, 92.60116389587637, 71.14132119892655, 68.57297331179578, 38.45648523994163, 70.28040362376726, 39.0017986397383, 33.169904806303435, 52.164577662024314, 56.6324767561174, 58.02640629473291, 85.6410219393639, 75.18482585663281, 67.29247360757968, 43.64607503398281, 76.98147305841545], "episode_lengths": [166, 269, 185, 227, 247, 167, 187, 176, 273, 140, 185, 264, 189, 167, 219, 271, 213, 176, 261, 223, 276, 209, 184, 243]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0866867363683874, "mean_inference_ms": 1.8731192486776795, "mean_action_processing_ms": 0.09328033343687231, "mean_env_wait_ms": 56.31854764241816, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 20800, "timesteps_this_iter": 0, "agent_timesteps_total": 20800, "timers": {"sample_time_ms": 154879.47, "sample_throughput": 67.149, "load_time_ms": 0.499, "load_throughput": 20841262.112, "learn_time_ms": 2745.299, "learn_throughput": 3788.295, "update_time_ms": 1.517}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.2, "cur_lr": 0.0005, "total_loss": 414.9649719238281, "policy_loss": 0.023168892413377763, "vf_loss": 415.0862731933594, "vf_explained_var": 0.009355390071868896, "kl": 0.0035804475949707147, "entropy": 14.51555519104004, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 20800, "num_agent_steps_sampled": 20800, "num_steps_trained": 20800, "num_agent_steps_trained": 20800, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 24, "training_iteration": 2, "trial_id": "370a4_00000", "experiment_id": "1495134c1e64496d851df0205982c5a3", "date": "2024-01-04_09-38-28", "timestamp": 1704332308, "time_this_iter_s": 154.17103362083435, "time_total_s": 312.3810091018677, "pid": 13208, "hostname": "DESKTOP-CC49RT1", "node_ip": "127.0.0.1", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 10000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "aircombat", "env_args": {"map_name": "MultipleCombat_4v4/NoWeapon/vsBaseline"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": false, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 10, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box(-10.0, 10.0, (51,), float32))", "space_act": "MultiDiscrete([41 41 41 30])", "num_agents": 4, "episode_limit": 1000, "policy_mapping_info": {"MultipleCombat_2v2/NoWeapon/Selfplay": {"description": "aircombat AI vs AI", "team_prefix": ["teamA_", "teamB_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "MultipleCombat_2v2/NoWeapon/vsBaseline": {"description": "aircombat AI vs Bot", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "MultipleCombat_4v4/NoWeapon/vsBaseline": {"description": "aircombat AI vs Bot", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["agent_0", "agent_1", "agent_2", "agent_3"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "aircombat_MultipleCombat_4v4/NoWeapon/vsBaseline", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x0000021245806AF0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 10000, "shuffle_sequences": true, "num_sgd_iter": 5, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 312.3810091018677, "timesteps_since_restore": 0, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 23.925114155251144, "ram_util_percent": 47.781735159817345}}
{"episode_reward_max": 164.91356221013916, "episode_reward_min": 24.91198223283981, "episode_reward_mean": 72.47767429882408, "episode_len_mean": 211.19444444444446, "episode_media": {}, "episodes_this_iter": 12, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [85.52604742973261, 74.32881534281108, 123.00724534703993, 87.56172885932136, 62.75245348000842, 164.91356221013916, 57.26511589040773, 142.0714879741194, 24.91198223283981, 92.60116389587637, 71.14132119892655, 68.57297331179578, 38.45648523994163, 70.28040362376726, 39.0017986397383, 33.169904806303435, 52.164577662024314, 56.6324767561174, 58.02640629473291, 85.6410219393639, 75.18482585663281, 67.29247360757968, 43.64607503398281, 76.98147305841545, 70.63357358776804, 125.75123694001434, 72.6391704255143, 71.43968015284922, 94.17021768657605, 41.41211775392724, 35.713066579692544, 69.61378392823792, 62.871313361170564, 86.06722175206238, 59.70291043183701, 68.05016246639923], "episode_lengths": [166, 269, 185, 227, 247, 167, 187, 176, 273, 140, 185, 264, 189, 167, 219, 271, 213, 176, 261, 223, 276, 209, 184, 243, 215, 194, 223, 189, 217, 228, 237, 188, 185, 171, 212, 227]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0831150095657422, "mean_inference_ms": 1.8688059885708226, "mean_action_processing_ms": 0.09285710672615201, "mean_env_wait_ms": 56.25545496952989, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 31200, "timesteps_this_iter": 0, "agent_timesteps_total": 31200, "timers": {"sample_time_ms": 155805.242, "sample_throughput": 66.75, "load_time_ms": 0.333, "load_throughput": 31261893.168, "learn_time_ms": 2730.789, "learn_throughput": 3808.424, "update_time_ms": 1.369}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.1, "cur_lr": 0.0005, "total_loss": 423.3781005859375, "policy_loss": -0.00203054363373667, "vf_loss": 423.524658203125, "vf_explained_var": 0.02177499532699585, "kl": 0.003350640748116351, "entropy": 14.489568138122559, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 31200, "num_agent_steps_sampled": 31200, "num_steps_trained": 31200, "num_agent_steps_trained": 31200, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 36, "training_iteration": 3, "trial_id": "370a4_00000", "experiment_id": "1495134c1e64496d851df0205982c5a3", "date": "2024-01-04_09-41-06", "timestamp": 1704332466, "time_this_iter_s": 157.5179259777069, "time_total_s": 469.8989350795746, "pid": 13208, "hostname": "DESKTOP-CC49RT1", "node_ip": "127.0.0.1", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 10000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "aircombat", "env_args": {"map_name": "MultipleCombat_4v4/NoWeapon/vsBaseline"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": false, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 10, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box(-10.0, 10.0, (51,), float32))", "space_act": "MultiDiscrete([41 41 41 30])", "num_agents": 4, "episode_limit": 1000, "policy_mapping_info": {"MultipleCombat_2v2/NoWeapon/Selfplay": {"description": "aircombat AI vs AI", "team_prefix": ["teamA_", "teamB_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "MultipleCombat_2v2/NoWeapon/vsBaseline": {"description": "aircombat AI vs Bot", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "MultipleCombat_4v4/NoWeapon/vsBaseline": {"description": "aircombat AI vs Bot", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["agent_0", "agent_1", "agent_2", "agent_3"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "aircombat_MultipleCombat_4v4/NoWeapon/vsBaseline", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x0000021245994C10>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 10000, "shuffle_sequences": true, "num_sgd_iter": 5, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 469.8989350795746, "timesteps_since_restore": 0, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 23.902690582959643, "ram_util_percent": 48.5219730941704}}
{"episode_reward_max": 164.91356221013916, "episode_reward_min": 24.91198223283981, "episode_reward_mean": 71.9374573215309, "episode_len_mean": 211.89795918367346, "episode_media": {}, "episodes_this_iter": 13, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [85.52604742973261, 74.32881534281108, 123.00724534703993, 87.56172885932136, 62.75245348000842, 164.91356221013916, 57.26511589040773, 142.0714879741194, 24.91198223283981, 92.60116389587637, 71.14132119892655, 68.57297331179578, 38.45648523994163, 70.28040362376726, 39.0017986397383, 33.169904806303435, 52.164577662024314, 56.6324767561174, 58.02640629473291, 85.6410219393639, 75.18482585663281, 67.29247360757968, 43.64607503398281, 76.98147305841545, 70.63357358776804, 125.75123694001434, 72.6391704255143, 71.43968015284922, 94.17021768657605, 41.41211775392724, 35.713066579692544, 69.61378392823792, 62.871313361170564, 86.06722175206238, 59.70291043183701, 68.05016246639923, 37.294866530045994, 69.70733421948788, 114.37626999224159, 51.842578276075756, 83.67815530192092, 56.34587438881507, 61.86556054466498, 76.53784419182423, 90.46264693068142, 44.67924990459075, 48.42611024787564, 120.27495997456862, 60.247683494554494], "episode_lengths": [166, 269, 185, 227, 247, 167, 187, 176, 273, 140, 185, 264, 189, 167, 219, 271, 213, 176, 261, 223, 276, 209, 184, 243, 215, 194, 223, 189, 217, 228, 237, 188, 185, 171, 212, 227, 230, 349, 227, 200, 195, 283, 189, 209, 161, 193, 183, 185, 176]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0846646936506261, "mean_inference_ms": 1.8656206708179608, "mean_action_processing_ms": 0.09242936783549749, "mean_env_wait_ms": 56.24230474641717, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 41600, "timesteps_this_iter": 0, "agent_timesteps_total": 41600, "timers": {"sample_time_ms": 156226.164, "sample_throughput": 66.57, "load_time_ms": 0.492, "load_throughput": 21144334.27, "learn_time_ms": 2699.049, "learn_throughput": 3853.209, "update_time_ms": 1.277}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.05, "cur_lr": 0.0005, "total_loss": 332.21869506835935, "policy_loss": -0.02095027845352888, "vf_loss": 332.38409423828125, "vf_explained_var": 0.04165120124816894, "kl": 0.0028952030129772545, "entropy": 14.458651542663574, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 41600, "num_agent_steps_sampled": 41600, "num_steps_trained": 41600, "num_agent_steps_trained": 41600, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 49, "training_iteration": 4, "trial_id": "370a4_00000", "experiment_id": "1495134c1e64496d851df0205982c5a3", "date": "2024-01-04_09-43-43", "timestamp": 1704332623, "time_this_iter_s": 157.36688351631165, "time_total_s": 627.2658185958862, "pid": 13208, "hostname": "DESKTOP-CC49RT1", "node_ip": "127.0.0.1", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 10000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "aircombat", "env_args": {"map_name": "MultipleCombat_4v4/NoWeapon/vsBaseline"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": false, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 10, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box(-10.0, 10.0, (51,), float32))", "space_act": "MultiDiscrete([41 41 41 30])", "num_agents": 4, "episode_limit": 1000, "policy_mapping_info": {"MultipleCombat_2v2/NoWeapon/Selfplay": {"description": "aircombat AI vs AI", "team_prefix": ["teamA_", "teamB_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "MultipleCombat_2v2/NoWeapon/vsBaseline": {"description": "aircombat AI vs Bot", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "MultipleCombat_4v4/NoWeapon/vsBaseline": {"description": "aircombat AI vs Bot", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["agent_0", "agent_1", "agent_2", "agent_3"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "aircombat_MultipleCombat_4v4/NoWeapon/vsBaseline", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x000002124579FE50>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 10000, "shuffle_sequences": true, "num_sgd_iter": 5, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 627.2658185958862, "timesteps_since_restore": 0, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 23.823766816143497, "ram_util_percent": 48.704484304932734}}
{"episode_reward_max": 164.91356221013916, "episode_reward_min": 17.33558107306832, "episode_reward_mean": 68.62979713515156, "episode_len_mean": 221.41379310344828, "episode_media": {}, "episodes_this_iter": 9, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [85.52604742973261, 74.32881534281108, 123.00724534703993, 87.56172885932136, 62.75245348000842, 164.91356221013916, 57.26511589040773, 142.0714879741194, 24.91198223283981, 92.60116389587637, 71.14132119892655, 68.57297331179578, 38.45648523994163, 70.28040362376726, 39.0017986397383, 33.169904806303435, 52.164577662024314, 56.6324767561174, 58.02640629473291, 85.6410219393639, 75.18482585663281, 67.29247360757968, 43.64607503398281, 76.98147305841545, 70.63357358776804, 125.75123694001434, 72.6391704255143, 71.43968015284922, 94.17021768657605, 41.41211775392724, 35.713066579692544, 69.61378392823792, 62.871313361170564, 86.06722175206238, 59.70291043183701, 68.05016246639923, 37.294866530045994, 69.70733421948788, 114.37626999224159, 51.842578276075756, 83.67815530192092, 56.34587438881507, 61.86556054466498, 76.53784419182423, 90.46264693068142, 44.67924990459075, 48.42611024787564, 120.27495997456862, 60.247683494554494, 64.43613833141711, 65.26574145644474, 50.878825728287325, 94.52675250125947, 17.33558107306832, 57.10487344512933, 34.3816140490485, 17.790385380307207, 53.87291311881475], "episode_lengths": [166, 269, 185, 227, 247, 167, 187, 176, 273, 140, 185, 264, 189, 167, 219, 271, 213, 176, 261, 223, 276, 209, 184, 243, 215, 194, 223, 189, 217, 228, 237, 188, 185, 171, 212, 227, 230, 349, 227, 200, 195, 283, 189, 209, 161, 193, 183, 185, 176, 291, 224, 237, 220, 532, 266, 216, 279, 194]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0799258340833682, "mean_inference_ms": 1.8626805779874767, "mean_action_processing_ms": 0.09230051232910656, "mean_env_wait_ms": 56.13032171068875, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 52000, "timesteps_this_iter": 0, "agent_timesteps_total": 52000, "timers": {"sample_time_ms": 154428.71, "sample_throughput": 67.345, "load_time_ms": 0.586, "load_throughput": 17759450.208, "learn_time_ms": 2648.45, "learn_throughput": 3926.825, "update_time_ms": 1.416}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.025, "cur_lr": 0.0005, "total_loss": 313.67107543945315, "policy_loss": -0.001998434180859476, "vf_loss": 313.8174133300781, "vf_explained_var": 0.07081960439682007, "kl": 0.0030402496528594723, "entropy": 14.440481185913086, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 52000, "num_agent_steps_sampled": 52000, "num_steps_trained": 52000, "num_agent_steps_trained": 52000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 58, "training_iteration": 5, "trial_id": "370a4_00000", "experiment_id": "1495134c1e64496d851df0205982c5a3", "date": "2024-01-04_09-46-10", "timestamp": 1704332770, "time_this_iter_s": 147.05851411819458, "time_total_s": 774.3243327140808, "pid": 13208, "hostname": "DESKTOP-CC49RT1", "node_ip": "127.0.0.1", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 10000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "aircombat", "env_args": {"map_name": "MultipleCombat_4v4/NoWeapon/vsBaseline"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": false, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 10, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box(-10.0, 10.0, (51,), float32))", "space_act": "MultiDiscrete([41 41 41 30])", "num_agents": 4, "episode_limit": 1000, "policy_mapping_info": {"MultipleCombat_2v2/NoWeapon/Selfplay": {"description": "aircombat AI vs AI", "team_prefix": ["teamA_", "teamB_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "MultipleCombat_2v2/NoWeapon/vsBaseline": {"description": "aircombat AI vs Bot", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "MultipleCombat_4v4/NoWeapon/vsBaseline": {"description": "aircombat AI vs Bot", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["agent_0", "agent_1", "agent_2", "agent_3"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "aircombat_MultipleCombat_4v4/NoWeapon/vsBaseline", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x000002124579FF70>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 10000, "shuffle_sequences": true, "num_sgd_iter": 5, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 774.3243327140808, "timesteps_since_restore": 0, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 21.754807692307693, "ram_util_percent": 49.107211538461534}}
{"episode_reward_max": 164.91356221013916, "episode_reward_min": 17.33558107306832, "episode_reward_mean": 68.29893927545804, "episode_len_mean": 222.66666666666666, "episode_media": {}, "episodes_this_iter": 11, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [85.52604742973261, 74.32881534281108, 123.00724534703993, 87.56172885932136, 62.75245348000842, 164.91356221013916, 57.26511589040773, 142.0714879741194, 24.91198223283981, 92.60116389587637, 71.14132119892655, 68.57297331179578, 38.45648523994163, 70.28040362376726, 39.0017986397383, 33.169904806303435, 52.164577662024314, 56.6324767561174, 58.02640629473291, 85.6410219393639, 75.18482585663281, 67.29247360757968, 43.64607503398281, 76.98147305841545, 70.63357358776804, 125.75123694001434, 72.6391704255143, 71.43968015284922, 94.17021768657605, 41.41211775392724, 35.713066579692544, 69.61378392823792, 62.871313361170564, 86.06722175206238, 59.70291043183701, 68.05016246639923, 37.294866530045994, 69.70733421948788, 114.37626999224159, 51.842578276075756, 83.67815530192092, 56.34587438881507, 61.86556054466498, 76.53784419182423, 90.46264693068142, 44.67924990459075, 48.42611024787564, 120.27495997456862, 60.247683494554494, 64.43613833141711, 65.26574145644474, 50.878825728287325, 94.52675250125947, 17.33558107306832, 57.10487344512933, 34.3816140490485, 17.790385380307207, 53.87291311881475, 130.55765626996697, 35.70533715739822, 90.54056328022779, 87.93347185112623, 38.3254180334949, 28.740362037006705, 97.63447138915137, 68.24296402837973, 27.045927589013417, 57.196051527351955, 70.17635300469652], "episode_lengths": [166, 269, 185, 227, 247, 167, 187, 176, 273, 140, 185, 264, 189, 167, 219, 271, 213, 176, 261, 223, 276, 209, 184, 243, 215, 194, 223, 189, 217, 228, 237, 188, 185, 171, 212, 227, 230, 349, 227, 200, 195, 283, 189, 209, 161, 193, 183, 185, 176, 291, 224, 237, 220, 532, 266, 216, 279, 194, 207, 225, 234, 254, 184, 305, 191, 174, 333, 228, 187]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0747318058057502, "mean_inference_ms": 1.858779604659798, "mean_action_processing_ms": 0.09237860289170277, "mean_env_wait_ms": 56.00881413653088, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 62400, "timesteps_this_iter": 0, "agent_timesteps_total": 62400, "timers": {"sample_time_ms": 154036.433, "sample_throughput": 67.516, "load_time_ms": 0.488, "load_throughput": 21311340.249, "learn_time_ms": 2638.33, "learn_throughput": 3941.888, "update_time_ms": 1.509}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0125, "cur_lr": 0.0005, "total_loss": 317.7199768066406, "policy_loss": -0.023000071942806243, "vf_loss": 317.8868347167969, "vf_explained_var": 0.11899604797363281, "kl": 0.0034382385988980914, "entropy": 14.39106101989746, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 62400, "num_agent_steps_sampled": 62400, "num_steps_trained": 62400, "num_agent_steps_trained": 62400, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 69, "training_iteration": 6, "trial_id": "370a4_00000", "experiment_id": "1495134c1e64496d851df0205982c5a3", "date": "2024-01-04_09-48-42", "timestamp": 1704332922, "time_this_iter_s": 152.19094252586365, "time_total_s": 926.5152752399445, "pid": 13208, "hostname": "DESKTOP-CC49RT1", "node_ip": "127.0.0.1", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 10000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "aircombat", "env_args": {"map_name": "MultipleCombat_4v4/NoWeapon/vsBaseline"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": false, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 10, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box(-10.0, 10.0, (51,), float32))", "space_act": "MultiDiscrete([41 41 41 30])", "num_agents": 4, "episode_limit": 1000, "policy_mapping_info": {"MultipleCombat_2v2/NoWeapon/Selfplay": {"description": "aircombat AI vs AI", "team_prefix": ["teamA_", "teamB_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "MultipleCombat_2v2/NoWeapon/vsBaseline": {"description": "aircombat AI vs Bot", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "MultipleCombat_4v4/NoWeapon/vsBaseline": {"description": "aircombat AI vs Bot", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["agent_0", "agent_1", "agent_2", "agent_3"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "aircombat_MultipleCombat_4v4/NoWeapon/vsBaseline", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x00000212457F4EE0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 10000, "shuffle_sequences": true, "num_sgd_iter": 5, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 926.5152752399445, "timesteps_since_restore": 0, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 21.104166666666668, "ram_util_percent": 49.979629629629635}}
{"episode_reward_max": 164.91356221013916, "episode_reward_min": -25.859143978006266, "episode_reward_mean": 66.94375349579866, "episode_len_mean": 225.925, "episode_media": {}, "episodes_this_iter": 11, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [85.52604742973261, 74.32881534281108, 123.00724534703993, 87.56172885932136, 62.75245348000842, 164.91356221013916, 57.26511589040773, 142.0714879741194, 24.91198223283981, 92.60116389587637, 71.14132119892655, 68.57297331179578, 38.45648523994163, 70.28040362376726, 39.0017986397383, 33.169904806303435, 52.164577662024314, 56.6324767561174, 58.02640629473291, 85.6410219393639, 75.18482585663281, 67.29247360757968, 43.64607503398281, 76.98147305841545, 70.63357358776804, 125.75123694001434, 72.6391704255143, 71.43968015284922, 94.17021768657605, 41.41211775392724, 35.713066579692544, 69.61378392823792, 62.871313361170564, 86.06722175206238, 59.70291043183701, 68.05016246639923, 37.294866530045994, 69.70733421948788, 114.37626999224159, 51.842578276075756, 83.67815530192092, 56.34587438881507, 61.86556054466498, 76.53784419182423, 90.46264693068142, 44.67924990459075, 48.42611024787564, 120.27495997456862, 60.247683494554494, 64.43613833141711, 65.26574145644474, 50.878825728287325, 94.52675250125947, 17.33558107306832, 57.10487344512933, 34.3816140490485, 17.790385380307207, 53.87291311881475, 130.55765626996697, 35.70533715739822, 90.54056328022779, 87.93347185112623, 38.3254180334949, 28.740362037006705, 97.63447138915137, 68.24296402837973, 27.045927589013417, 57.196051527351955, 70.17635300469652, 77.03287320039763, 26.932935113989046, -25.859143978006266, 113.81841671915544, 34.65326629400025, 98.55030413132255, 64.60699893249688, 74.56952112897568, 49.54010569184412, 61.61319764766326, 67.41499477544983], "episode_lengths": [166, 269, 185, 227, 247, 167, 187, 176, 273, 140, 185, 264, 189, 167, 219, 271, 213, 176, 261, 223, 276, 209, 184, 243, 215, 194, 223, 189, 217, 228, 237, 188, 185, 171, 212, 227, 230, 349, 227, 200, 195, 283, 189, 209, 161, 193, 183, 185, 176, 291, 224, 237, 220, 532, 266, 216, 279, 194, 207, 225, 234, 254, 184, 305, 191, 174, 333, 228, 187, 246, 267, 341, 183, 333, 186, 186, 213, 210, 304, 241]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0711963086923237, "mean_inference_ms": 1.856536727873302, "mean_action_processing_ms": 0.09240698303097065, "mean_env_wait_ms": 55.93551127873652, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 72800, "timesteps_this_iter": 0, "agent_timesteps_total": 72800, "timers": {"sample_time_ms": 154380.168, "sample_throughput": 67.366, "load_time_ms": 0.565, "load_throughput": 18414264.335, "learn_time_ms": 2625.598, "learn_throughput": 3961.003, "update_time_ms": 1.435}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.00625, "cur_lr": 0.0005, "total_loss": 327.8821655273438, "policy_loss": 0.02504654824733734, "vf_loss": 328.0007690429687, "vf_explained_var": 0.16441788673400878, "kl": 0.002972474641788558, "entropy": 14.365935134887696, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 72800, "num_agent_steps_sampled": 72800, "num_steps_trained": 72800, "num_agent_steps_trained": 72800, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 80, "training_iteration": 7, "trial_id": "370a4_00000", "experiment_id": "1495134c1e64496d851df0205982c5a3", "date": "2024-01-04_09-51-19", "timestamp": 1704333079, "time_this_iter_s": 156.37797117233276, "time_total_s": 1082.8932464122772, "pid": 13208, "hostname": "DESKTOP-CC49RT1", "node_ip": "127.0.0.1", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 10000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "aircombat", "env_args": {"map_name": "MultipleCombat_4v4/NoWeapon/vsBaseline"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": false, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 10, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box(-10.0, 10.0, (51,), float32))", "space_act": "MultiDiscrete([41 41 41 30])", "num_agents": 4, "episode_limit": 1000, "policy_mapping_info": {"MultipleCombat_2v2/NoWeapon/Selfplay": {"description": "aircombat AI vs AI", "team_prefix": ["teamA_", "teamB_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "MultipleCombat_2v2/NoWeapon/vsBaseline": {"description": "aircombat AI vs Bot", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "MultipleCombat_4v4/NoWeapon/vsBaseline": {"description": "aircombat AI vs Bot", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["agent_0", "agent_1", "agent_2", "agent_3"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "aircombat_MultipleCombat_4v4/NoWeapon/vsBaseline", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x00000212459980D0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 10000, "shuffle_sequences": true, "num_sgd_iter": 5, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1082.8932464122772, "timesteps_since_restore": 0, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 23.470588235294116, "ram_util_percent": 51.85294117647059}}
{"episode_reward_max": 164.91356221013916, "episode_reward_min": -25.859143978006266, "episode_reward_mean": 67.31385734826974, "episode_len_mean": 225.82608695652175, "episode_media": {}, "episodes_this_iter": 12, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [85.52604742973261, 74.32881534281108, 123.00724534703993, 87.56172885932136, 62.75245348000842, 164.91356221013916, 57.26511589040773, 142.0714879741194, 24.91198223283981, 92.60116389587637, 71.14132119892655, 68.57297331179578, 38.45648523994163, 70.28040362376726, 39.0017986397383, 33.169904806303435, 52.164577662024314, 56.6324767561174, 58.02640629473291, 85.6410219393639, 75.18482585663281, 67.29247360757968, 43.64607503398281, 76.98147305841545, 70.63357358776804, 125.75123694001434, 72.6391704255143, 71.43968015284922, 94.17021768657605, 41.41211775392724, 35.713066579692544, 69.61378392823792, 62.871313361170564, 86.06722175206238, 59.70291043183701, 68.05016246639923, 37.294866530045994, 69.70733421948788, 114.37626999224159, 51.842578276075756, 83.67815530192092, 56.34587438881507, 61.86556054466498, 76.53784419182423, 90.46264693068142, 44.67924990459075, 48.42611024787564, 120.27495997456862, 60.247683494554494, 64.43613833141711, 65.26574145644474, 50.878825728287325, 94.52675250125947, 17.33558107306832, 57.10487344512933, 34.3816140490485, 17.790385380307207, 53.87291311881475, 130.55765626996697, 35.70533715739822, 90.54056328022779, 87.93347185112623, 38.3254180334949, 28.740362037006705, 97.63447138915137, 68.24296402837973, 27.045927589013417, 57.196051527351955, 70.17635300469652, 77.03287320039763, 26.932935113989046, -25.859143978006266, 113.81841671915544, 34.65326629400025, 98.55030413132255, 64.60699893249688, 74.56952112897568, 49.54010569184412, 61.61319764766326, 67.41499477544983, -24.350778835828287, 111.72151667021234, 11.797963401480695, 109.3565072579629, 134.03964095486248, 98.03771665808237, -17.964044401290664, 72.31115404789318, 103.55912794181052, 147.26064573767798, 62.78576567682303, 28.819381267236736], "episode_lengths": [166, 269, 185, 227, 247, 167, 187, 176, 273, 140, 185, 264, 189, 167, 219, 271, 213, 176, 261, 223, 276, 209, 184, 243, 215, 194, 223, 189, 217, 228, 237, 188, 185, 171, 212, 227, 230, 349, 227, 200, 195, 283, 189, 209, 161, 193, 183, 185, 176, 291, 224, 237, 220, 532, 266, 216, 279, 194, 207, 225, 234, 254, 184, 305, 191, 174, 333, 228, 187, 246, 267, 341, 183, 333, 186, 186, 213, 210, 304, 241, 390, 211, 237, 271, 168, 179, 266, 200, 190, 187, 179, 224]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0698894636247542, "mean_inference_ms": 1.8549359298855328, "mean_action_processing_ms": 0.0922860748361807, "mean_env_wait_ms": 55.866409211825435, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 83200, "timesteps_this_iter": 0, "agent_timesteps_total": 83200, "timers": {"sample_time_ms": 154265.562, "sample_throughput": 67.416, "load_time_ms": 0.494, "load_throughput": 21044873.526, "learn_time_ms": 2635.814, "learn_throughput": 3945.65, "update_time_ms": 1.627}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.003125, "cur_lr": 0.0005, "total_loss": 286.0367797851562, "policy_loss": -0.023427044972777367, "vf_loss": 286.2037353515625, "vf_explained_var": 0.22372887134552003, "kl": 0.003606807324599312, "entropy": 14.35295467376709, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 83200, "num_agent_steps_sampled": 83200, "num_steps_trained": 83200, "num_agent_steps_trained": 83200, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 92, "training_iteration": 8, "trial_id": "370a4_00000", "experiment_id": "1495134c1e64496d851df0205982c5a3", "date": "2024-01-04_09-53-52", "timestamp": 1704333232, "time_this_iter_s": 153.5963749885559, "time_total_s": 1236.4896214008331, "pid": 13208, "hostname": "DESKTOP-CC49RT1", "node_ip": "127.0.0.1", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 10000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "aircombat", "env_args": {"map_name": "MultipleCombat_4v4/NoWeapon/vsBaseline"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": false, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 10, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box(-10.0, 10.0, (51,), float32))", "space_act": "MultiDiscrete([41 41 41 30])", "num_agents": 4, "episode_limit": 1000, "policy_mapping_info": {"MultipleCombat_2v2/NoWeapon/Selfplay": {"description": "aircombat AI vs AI", "team_prefix": ["teamA_", "teamB_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "MultipleCombat_2v2/NoWeapon/vsBaseline": {"description": "aircombat AI vs Bot", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "MultipleCombat_4v4/NoWeapon/vsBaseline": {"description": "aircombat AI vs Bot", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["agent_0", "agent_1", "agent_2", "agent_3"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "aircombat_MultipleCombat_4v4/NoWeapon/vsBaseline", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x00000212457F4670>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 10000, "shuffle_sequences": true, "num_sgd_iter": 5, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1236.4896214008331, "timesteps_since_restore": 0, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 21.600921658986174, "ram_util_percent": 53.26405529953917}}
{"episode_reward_max": 164.91356221013916, "episode_reward_min": -25.859143978006266, "episode_reward_mean": 67.52183169631516, "episode_len_mean": 223.6, "episode_media": {}, "episodes_this_iter": 12, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [62.75245348000842, 164.91356221013916, 57.26511589040773, 142.0714879741194, 24.91198223283981, 92.60116389587637, 71.14132119892655, 68.57297331179578, 38.45648523994163, 70.28040362376726, 39.0017986397383, 33.169904806303435, 52.164577662024314, 56.6324767561174, 58.02640629473291, 85.6410219393639, 75.18482585663281, 67.29247360757968, 43.64607503398281, 76.98147305841545, 70.63357358776804, 125.75123694001434, 72.6391704255143, 71.43968015284922, 94.17021768657605, 41.41211775392724, 35.713066579692544, 69.61378392823792, 62.871313361170564, 86.06722175206238, 59.70291043183701, 68.05016246639923, 37.294866530045994, 69.70733421948788, 114.37626999224159, 51.842578276075756, 83.67815530192092, 56.34587438881507, 61.86556054466498, 76.53784419182423, 90.46264693068142, 44.67924990459075, 48.42611024787564, 120.27495997456862, 60.247683494554494, 64.43613833141711, 65.26574145644474, 50.878825728287325, 94.52675250125947, 17.33558107306832, 57.10487344512933, 34.3816140490485, 17.790385380307207, 53.87291311881475, 130.55765626996697, 35.70533715739822, 90.54056328022779, 87.93347185112623, 38.3254180334949, 28.740362037006705, 97.63447138915137, 68.24296402837973, 27.045927589013417, 57.196051527351955, 70.17635300469652, 77.03287320039763, 26.932935113989046, -25.859143978006266, 113.81841671915544, 34.65326629400025, 98.55030413132255, 64.60699893249688, 74.56952112897568, 49.54010569184412, 61.61319764766326, 67.41499477544983, -24.350778835828287, 111.72151667021234, 11.797963401480695, 109.3565072579629, 134.03964095486248, 98.03771665808237, -17.964044401290664, 72.31115404789318, 103.55912794181052, 147.26064573767798, 62.78576567682303, 28.819381267236736, 71.73255479447559, 115.09005564686275, 52.43610193633195, 75.49855962503392, 96.93720560880743, 65.25096327920242, 45.734969816303334, 64.72774425662445, 100.34354864303211, 32.87730263914995, 103.86679194478938, 105.23633237899162], "episode_lengths": [247, 167, 187, 176, 273, 140, 185, 264, 189, 167, 219, 271, 213, 176, 261, 223, 276, 209, 184, 243, 215, 194, 223, 189, 217, 228, 237, 188, 185, 171, 212, 227, 230, 349, 227, 200, 195, 283, 189, 209, 161, 193, 183, 185, 176, 291, 224, 237, 220, 532, 266, 216, 279, 194, 207, 225, 234, 254, 184, 305, 191, 174, 333, 228, 187, 246, 267, 341, 183, 333, 186, 186, 213, 210, 304, 241, 390, 211, 237, 271, 168, 179, 266, 200, 190, 187, 179, 224, 295, 167, 180, 155, 166, 173, 213, 204, 212, 229, 193, 244]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0678829834692516, "mean_inference_ms": 1.853662065476036, "mean_action_processing_ms": 0.09199512184913732, "mean_env_wait_ms": 55.80872727788253, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 93600, "timesteps_this_iter": 0, "agent_timesteps_total": 93600, "timers": {"sample_time_ms": 154999.884, "sample_throughput": 67.097, "load_time_ms": 0.439, "load_throughput": 23675482.716, "learn_time_ms": 2650.193, "learn_throughput": 3924.242, "update_time_ms": 1.668}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0015625, "cur_lr": 0.0005, "total_loss": 303.39263916015625, "policy_loss": -0.004797783173853531, "vf_loss": 303.5403198242187, "vf_explained_var": 0.2657877206802368, "kl": 0.003924828767882443, "entropy": 14.288604354858398, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 93600, "num_agent_steps_sampled": 93600, "num_steps_trained": 93600, "num_agent_steps_trained": 93600, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 104, "training_iteration": 9, "trial_id": "370a4_00000", "experiment_id": "1495134c1e64496d851df0205982c5a3", "date": "2024-01-04_09-56-33", "timestamp": 1704333393, "time_this_iter_s": 160.8748848438263, "time_total_s": 1397.3645062446594, "pid": 13208, "hostname": "DESKTOP-CC49RT1", "node_ip": "127.0.0.1", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 10000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "aircombat", "env_args": {"map_name": "MultipleCombat_4v4/NoWeapon/vsBaseline"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": false, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 10, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box(-10.0, 10.0, (51,), float32))", "space_act": "MultiDiscrete([41 41 41 30])", "num_agents": 4, "episode_limit": 1000, "policy_mapping_info": {"MultipleCombat_2v2/NoWeapon/Selfplay": {"description": "aircombat AI vs AI", "team_prefix": ["teamA_", "teamB_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "MultipleCombat_2v2/NoWeapon/vsBaseline": {"description": "aircombat AI vs Bot", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "MultipleCombat_4v4/NoWeapon/vsBaseline": {"description": "aircombat AI vs Bot", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["agent_0", "agent_1", "agent_2", "agent_3"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "aircombat_MultipleCombat_4v4/NoWeapon/vsBaseline", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x00000212457BC040>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 10000, "shuffle_sequences": true, "num_sgd_iter": 5, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1397.3645062446594, "timesteps_since_restore": 0, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 23.696491228070176, "ram_util_percent": 53.38728070175439}}
{"episode_reward_max": 147.26064573767798, "episode_reward_min": -25.859143978006266, "episode_reward_mean": 63.116334095335816, "episode_len_mean": 231.54, "episode_media": {}, "episodes_this_iter": 9, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [70.28040362376726, 39.0017986397383, 33.169904806303435, 52.164577662024314, 56.6324767561174, 58.02640629473291, 85.6410219393639, 75.18482585663281, 67.29247360757968, 43.64607503398281, 76.98147305841545, 70.63357358776804, 125.75123694001434, 72.6391704255143, 71.43968015284922, 94.17021768657605, 41.41211775392724, 35.713066579692544, 69.61378392823792, 62.871313361170564, 86.06722175206238, 59.70291043183701, 68.05016246639923, 37.294866530045994, 69.70733421948788, 114.37626999224159, 51.842578276075756, 83.67815530192092, 56.34587438881507, 61.86556054466498, 76.53784419182423, 90.46264693068142, 44.67924990459075, 48.42611024787564, 120.27495997456862, 60.247683494554494, 64.43613833141711, 65.26574145644474, 50.878825728287325, 94.52675250125947, 17.33558107306832, 57.10487344512933, 34.3816140490485, 17.790385380307207, 53.87291311881475, 130.55765626996697, 35.70533715739822, 90.54056328022779, 87.93347185112623, 38.3254180334949, 28.740362037006705, 97.63447138915137, 68.24296402837973, 27.045927589013417, 57.196051527351955, 70.17635300469652, 77.03287320039763, 26.932935113989046, -25.859143978006266, 113.81841671915544, 34.65326629400025, 98.55030413132255, 64.60699893249688, 74.56952112897568, 49.54010569184412, 61.61319764766326, 67.41499477544983, -24.350778835828287, 111.72151667021234, 11.797963401480695, 109.3565072579629, 134.03964095486248, 98.03771665808237, -17.964044401290664, 72.31115404789318, 103.55912794181052, 147.26064573767798, 62.78576567682303, 28.819381267236736, 71.73255479447559, 115.09005564686275, 52.43610193633195, 75.49855962503392, 96.93720560880743, 65.25096327920242, 45.734969816303334, 64.72774425662445, 100.34354864303211, 32.87730263914995, 103.86679194478938, 105.23633237899162, -21.31906944544958, 36.55446702130075, -24.12417735690823, 60.34700093717592, -20.30327219655075, 86.34418803495481, 43.15694067796696, 60.129381815089644, 61.35132584854006], "episode_lengths": [167, 219, 271, 213, 176, 261, 223, 276, 209, 184, 243, 215, 194, 223, 189, 217, 228, 237, 188, 185, 171, 212, 227, 230, 349, 227, 200, 195, 283, 189, 209, 161, 193, 183, 185, 176, 291, 224, 237, 220, 532, 266, 216, 279, 194, 207, 225, 234, 254, 184, 305, 191, 174, 333, 228, 187, 246, 267, 341, 183, 333, 186, 186, 213, 210, 304, 241, 390, 211, 237, 271, 168, 179, 266, 200, 190, 187, 179, 224, 295, 167, 180, 155, 166, 173, 213, 204, 212, 229, 193, 244, 322, 207, 482, 218, 422, 245, 239, 259, 228]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.064147300340908, "mean_inference_ms": 1.8515597595204951, "mean_action_processing_ms": 0.09161946608434826, "mean_env_wait_ms": 55.71470752171885, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 104000, "timesteps_this_iter": 0, "agent_timesteps_total": 104000, "timers": {"sample_time_ms": 154774.241, "sample_throughput": 67.195, "load_time_ms": 0.497, "load_throughput": 20912201.735, "learn_time_ms": 2646.306, "learn_throughput": 3930.006, "update_time_ms": 1.698}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.00078125, "cur_lr": 0.0005, "total_loss": 236.07094116210936, "policy_loss": -0.0038901229621842504, "vf_loss": 236.2174102783203, "vf_explained_var": 0.31329219341278075, "kl": 0.0037494455415818086, "entropy": 14.260044288635253, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 104000, "num_agent_steps_sampled": 104000, "num_steps_trained": 104000, "num_agent_steps_trained": 104000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 113, "training_iteration": 10, "trial_id": "370a4_00000", "experiment_id": "1495134c1e64496d851df0205982c5a3", "date": "2024-01-04_09-59-06", "timestamp": 1704333546, "time_this_iter_s": 152.5562036037445, "time_total_s": 1549.920709848404, "pid": 13208, "hostname": "DESKTOP-CC49RT1", "node_ip": "127.0.0.1", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 10000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "aircombat", "env_args": {"map_name": "MultipleCombat_4v4/NoWeapon/vsBaseline"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": false, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 10, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box(-10.0, 10.0, (51,), float32))", "space_act": "MultiDiscrete([41 41 41 30])", "num_agents": 4, "episode_limit": 1000, "policy_mapping_info": {"MultipleCombat_2v2/NoWeapon/Selfplay": {"description": "aircombat AI vs AI", "team_prefix": ["teamA_", "teamB_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "MultipleCombat_2v2/NoWeapon/vsBaseline": {"description": "aircombat AI vs Bot", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "MultipleCombat_4v4/NoWeapon/vsBaseline": {"description": "aircombat AI vs Bot", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["agent_0", "agent_1", "agent_2", "agent_3"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "aircombat_MultipleCombat_4v4/NoWeapon/vsBaseline", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x00000212459B20D0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 10000, "shuffle_sequences": true, "num_sgd_iter": 5, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1549.920709848404, "timesteps_since_restore": 0, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 22.357407407407408, "ram_util_percent": 53.281944444444434}}
{"episode_reward_max": 154.81736577500453, "episode_reward_min": -25.859143978006266, "episode_reward_mean": 65.82789888317704, "episode_len_mean": 229.37, "episode_media": {}, "episodes_this_iter": 13, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [72.6391704255143, 71.43968015284922, 94.17021768657605, 41.41211775392724, 35.713066579692544, 69.61378392823792, 62.871313361170564, 86.06722175206238, 59.70291043183701, 68.05016246639923, 37.294866530045994, 69.70733421948788, 114.37626999224159, 51.842578276075756, 83.67815530192092, 56.34587438881507, 61.86556054466498, 76.53784419182423, 90.46264693068142, 44.67924990459075, 48.42611024787564, 120.27495997456862, 60.247683494554494, 64.43613833141711, 65.26574145644474, 50.878825728287325, 94.52675250125947, 17.33558107306832, 57.10487344512933, 34.3816140490485, 17.790385380307207, 53.87291311881475, 130.55765626996697, 35.70533715739822, 90.54056328022779, 87.93347185112623, 38.3254180334949, 28.740362037006705, 97.63447138915137, 68.24296402837973, 27.045927589013417, 57.196051527351955, 70.17635300469652, 77.03287320039763, 26.932935113989046, -25.859143978006266, 113.81841671915544, 34.65326629400025, 98.55030413132255, 64.60699893249688, 74.56952112897568, 49.54010569184412, 61.61319764766326, 67.41499477544983, -24.350778835828287, 111.72151667021234, 11.797963401480695, 109.3565072579629, 134.03964095486248, 98.03771665808237, -17.964044401290664, 72.31115404789318, 103.55912794181052, 147.26064573767798, 62.78576567682303, 28.819381267236736, 71.73255479447559, 115.09005564686275, 52.43610193633195, 75.49855962503392, 96.93720560880743, 65.25096327920242, 45.734969816303334, 64.72774425662445, 100.34354864303211, 32.87730263914995, 103.86679194478938, 105.23633237899162, -21.31906944544958, 36.55446702130075, -24.12417735690823, 60.34700093717592, -20.30327219655075, 86.34418803495481, 43.15694067796696, 60.129381815089644, 61.35132584854006, 154.81736577500453, 80.4213487352368, 64.44588128595427, 85.30755005302782, 17.01634219639747, 80.63347202328379, 116.69136028401263, 132.4806731585321, 64.61468279842487, 38.28630718478934, 82.4014297183823, 70.70526555852231, 137.74104781899467], "episode_lengths": [223, 189, 217, 228, 237, 188, 185, 171, 212, 227, 230, 349, 227, 200, 195, 283, 189, 209, 161, 193, 183, 185, 176, 291, 224, 237, 220, 532, 266, 216, 279, 194, 207, 225, 234, 254, 184, 305, 191, 174, 333, 228, 187, 246, 267, 341, 183, 333, 186, 186, 213, 210, 304, 241, 390, 211, 237, 271, 168, 179, 266, 200, 190, 187, 179, 224, 295, 167, 180, 155, 166, 173, 213, 204, 212, 229, 193, 244, 322, 207, 482, 218, 422, 245, 239, 259, 228, 172, 177, 277, 173, 305, 164, 170, 157, 197, 244, 176, 259, 163]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.062624527412638, "mean_inference_ms": 1.8509846388739646, "mean_action_processing_ms": 0.09133388515600174, "mean_env_wait_ms": 55.67976448978305, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 114400, "timesteps_this_iter": 0, "agent_timesteps_total": 114400, "timers": {"sample_time_ms": 155141.559, "sample_throughput": 67.036, "load_time_ms": 0.398, "load_throughput": 26162515.204, "learn_time_ms": 2665.429, "learn_throughput": 3901.811, "update_time_ms": 1.698}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.000390625, "cur_lr": 0.0005, "total_loss": 219.42059020996095, "policy_loss": 0.017337345890700816, "vf_loss": 219.54603576660156, "vf_explained_var": 0.3866976022720337, "kl": 0.0034807768658466688, "entropy": 14.277618408203125, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 114400, "num_agent_steps_sampled": 114400, "num_steps_trained": 114400, "num_agent_steps_trained": 114400, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 126, "training_iteration": 11, "trial_id": "370a4_00000", "experiment_id": "1495134c1e64496d851df0205982c5a3", "date": "2024-01-04_10-01-45", "timestamp": 1704333705, "time_this_iter_s": 159.5819501876831, "time_total_s": 1709.502660036087, "pid": 13208, "hostname": "DESKTOP-CC49RT1", "node_ip": "127.0.0.1", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 10000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "aircombat", "env_args": {"map_name": "MultipleCombat_4v4/NoWeapon/vsBaseline"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": false, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 10, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box(-10.0, 10.0, (51,), float32))", "space_act": "MultiDiscrete([41 41 41 30])", "num_agents": 4, "episode_limit": 1000, "policy_mapping_info": {"MultipleCombat_2v2/NoWeapon/Selfplay": {"description": "aircombat AI vs AI", "team_prefix": ["teamA_", "teamB_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "MultipleCombat_2v2/NoWeapon/vsBaseline": {"description": "aircombat AI vs Bot", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "MultipleCombat_4v4/NoWeapon/vsBaseline": {"description": "aircombat AI vs Bot", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["agent_0", "agent_1", "agent_2", "agent_3"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "aircombat_MultipleCombat_4v4/NoWeapon/vsBaseline", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x00000212459B3040>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 10000, "shuffle_sequences": true, "num_sgd_iter": 5, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1709.502660036087, "timesteps_since_restore": 0, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 23.719911504424783, "ram_util_percent": 52.315486725663725}}
{"episode_reward_max": 154.81736577500453, "episode_reward_min": -25.859143978006266, "episode_reward_mean": 67.14705233872735, "episode_len_mean": 228.75, "episode_media": {}, "episodes_this_iter": 12, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [114.37626999224159, 51.842578276075756, 83.67815530192092, 56.34587438881507, 61.86556054466498, 76.53784419182423, 90.46264693068142, 44.67924990459075, 48.42611024787564, 120.27495997456862, 60.247683494554494, 64.43613833141711, 65.26574145644474, 50.878825728287325, 94.52675250125947, 17.33558107306832, 57.10487344512933, 34.3816140490485, 17.790385380307207, 53.87291311881475, 130.55765626996697, 35.70533715739822, 90.54056328022779, 87.93347185112623, 38.3254180334949, 28.740362037006705, 97.63447138915137, 68.24296402837973, 27.045927589013417, 57.196051527351955, 70.17635300469652, 77.03287320039763, 26.932935113989046, -25.859143978006266, 113.81841671915544, 34.65326629400025, 98.55030413132255, 64.60699893249688, 74.56952112897568, 49.54010569184412, 61.61319764766326, 67.41499477544983, -24.350778835828287, 111.72151667021234, 11.797963401480695, 109.3565072579629, 134.03964095486248, 98.03771665808237, -17.964044401290664, 72.31115404789318, 103.55912794181052, 147.26064573767798, 62.78576567682303, 28.819381267236736, 71.73255479447559, 115.09005564686275, 52.43610193633195, 75.49855962503392, 96.93720560880743, 65.25096327920242, 45.734969816303334, 64.72774425662445, 100.34354864303211, 32.87730263914995, 103.86679194478938, 105.23633237899162, -21.31906944544958, 36.55446702130075, -24.12417735690823, 60.34700093717592, -20.30327219655075, 86.34418803495481, 43.15694067796696, 60.129381815089644, 61.35132584854006, 154.81736577500453, 80.4213487352368, 64.44588128595427, 85.30755005302782, 17.01634219639747, 80.63347202328379, 116.69136028401263, 132.4806731585321, 64.61468279842487, 38.28630718478934, 82.4014297183823, 70.70526555852231, 137.74104781899467, 95.18480373388508, 60.8790171649117, 52.82153180268786, 61.73451278829893, 127.78816726335084, 132.9165005509064, 81.35395997088926, 74.79875121476158, 64.05320647766364, -14.101706710639002, 79.1294612821901, 84.03898530392478], "episode_lengths": [227, 200, 195, 283, 189, 209, 161, 193, 183, 185, 176, 291, 224, 237, 220, 532, 266, 216, 279, 194, 207, 225, 234, 254, 184, 305, 191, 174, 333, 228, 187, 246, 267, 341, 183, 333, 186, 186, 213, 210, 304, 241, 390, 211, 237, 271, 168, 179, 266, 200, 190, 187, 179, 224, 295, 167, 180, 155, 166, 173, 213, 204, 212, 229, 193, 244, 322, 207, 482, 218, 422, 245, 239, 259, 228, 172, 177, 277, 173, 305, 164, 170, 157, 197, 244, 176, 259, 163, 230, 241, 259, 184, 261, 173, 177, 200, 158, 292, 222, 197]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0608313776347504, "mean_inference_ms": 1.8509004668743172, "mean_action_processing_ms": 0.09110056936981704, "mean_env_wait_ms": 55.63396849487553, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 124800, "timesteps_this_iter": 0, "agent_timesteps_total": 124800, "timers": {"sample_time_ms": 155469.434, "sample_throughput": 66.894, "load_time_ms": 0.398, "load_throughput": 26162515.204, "learn_time_ms": 2637.044, "learn_throughput": 3943.81, "update_time_ms": 1.606}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0001953125, "cur_lr": 0.0005, "total_loss": 219.99486389160157, "policy_loss": 0.01991814821958542, "vf_loss": 220.11726989746094, "vf_explained_var": 0.4156720876693726, "kl": 0.003125067390744041, "entropy": 14.23138256072998, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 124800, "num_agent_steps_sampled": 124800, "num_steps_trained": 124800, "num_agent_steps_trained": 124800, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 138, "training_iteration": 12, "trial_id": "370a4_00000", "experiment_id": "1495134c1e64496d851df0205982c5a3", "date": "2024-01-04_10-04-22", "timestamp": 1704333862, "time_this_iter_s": 156.96444630622864, "time_total_s": 1866.4671063423157, "pid": 13208, "hostname": "DESKTOP-CC49RT1", "node_ip": "127.0.0.1", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 10000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "aircombat", "env_args": {"map_name": "MultipleCombat_4v4/NoWeapon/vsBaseline"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": false, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 10, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box(-10.0, 10.0, (51,), float32))", "space_act": "MultiDiscrete([41 41 41 30])", "num_agents": 4, "episode_limit": 1000, "policy_mapping_info": {"MultipleCombat_2v2/NoWeapon/Selfplay": {"description": "aircombat AI vs AI", "team_prefix": ["teamA_", "teamB_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "MultipleCombat_2v2/NoWeapon/vsBaseline": {"description": "aircombat AI vs Bot", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "MultipleCombat_4v4/NoWeapon/vsBaseline": {"description": "aircombat AI vs Bot", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["agent_0", "agent_1", "agent_2", "agent_3"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "aircombat_MultipleCombat_4v4/NoWeapon/vsBaseline", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x00000212459DBF70>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 10000, "shuffle_sequences": true, "num_sgd_iter": 5, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1866.4671063423157, "timesteps_since_restore": 0, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 21.675225225225223, "ram_util_percent": 48.612612612612615}}
{"episode_reward_max": 162.47328078988545, "episode_reward_min": -25.859143978006266, "episode_reward_mean": 67.98260649139812, "episode_len_mean": 229.8, "episode_media": {}, "episodes_this_iter": 12, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [65.26574145644474, 50.878825728287325, 94.52675250125947, 17.33558107306832, 57.10487344512933, 34.3816140490485, 17.790385380307207, 53.87291311881475, 130.55765626996697, 35.70533715739822, 90.54056328022779, 87.93347185112623, 38.3254180334949, 28.740362037006705, 97.63447138915137, 68.24296402837973, 27.045927589013417, 57.196051527351955, 70.17635300469652, 77.03287320039763, 26.932935113989046, -25.859143978006266, 113.81841671915544, 34.65326629400025, 98.55030413132255, 64.60699893249688, 74.56952112897568, 49.54010569184412, 61.61319764766326, 67.41499477544983, -24.350778835828287, 111.72151667021234, 11.797963401480695, 109.3565072579629, 134.03964095486248, 98.03771665808237, -17.964044401290664, 72.31115404789318, 103.55912794181052, 147.26064573767798, 62.78576567682303, 28.819381267236736, 71.73255479447559, 115.09005564686275, 52.43610193633195, 75.49855962503392, 96.93720560880743, 65.25096327920242, 45.734969816303334, 64.72774425662445, 100.34354864303211, 32.87730263914995, 103.86679194478938, 105.23633237899162, -21.31906944544958, 36.55446702130075, -24.12417735690823, 60.34700093717592, -20.30327219655075, 86.34418803495481, 43.15694067796696, 60.129381815089644, 61.35132584854006, 154.81736577500453, 80.4213487352368, 64.44588128595427, 85.30755005302782, 17.01634219639747, 80.63347202328379, 116.69136028401263, 132.4806731585321, 64.61468279842487, 38.28630718478934, 82.4014297183823, 70.70526555852231, 137.74104781899467, 95.18480373388508, 60.8790171649117, 52.82153180268786, 61.73451278829893, 127.78816726335084, 132.9165005509064, 81.35395997088926, 74.79875121476158, 64.05320647766364, -14.101706710639002, 79.1294612821901, 84.03898530392478, 62.785083426289475, 113.1794763055326, 82.56318419084494, 162.47328078988545, 102.40307418221354, 65.19580810931808, 21.285615378810483, 74.58759202444617, 56.111394737124556, 100.5395820603697, 71.17302924817403, 44.43136639329863], "episode_lengths": [224, 237, 220, 532, 266, 216, 279, 194, 207, 225, 234, 254, 184, 305, 191, 174, 333, 228, 187, 246, 267, 341, 183, 333, 186, 186, 213, 210, 304, 241, 390, 211, 237, 271, 168, 179, 266, 200, 190, 187, 179, 224, 295, 167, 180, 155, 166, 173, 213, 204, 212, 229, 193, 244, 322, 207, 482, 218, 422, 245, 239, 259, 228, 172, 177, 277, 173, 305, 164, 170, 157, 197, 244, 176, 259, 163, 230, 241, 259, 184, 261, 173, 177, 200, 158, 292, 222, 197, 220, 201, 302, 155, 207, 227, 232, 253, 225, 188, 190, 197]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0582235046096937, "mean_inference_ms": 1.851251254239445, "mean_action_processing_ms": 0.09096011535620223, "mean_env_wait_ms": 55.5920067460688, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 135200, "timesteps_this_iter": 0, "agent_timesteps_total": 135200, "timers": {"sample_time_ms": 155382.126, "sample_throughput": 66.932, "load_time_ms": 0.398, "load_throughput": 26162515.204, "learn_time_ms": 2636.587, "learn_throughput": 3944.494, "update_time_ms": 1.696}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 9.765625e-05, "cur_lr": 0.0005, "total_loss": 197.1849365234375, "policy_loss": -0.005388657154981047, "vf_loss": 197.33257141113282, "vf_explained_var": 0.44678876399993894, "kl": 0.0036773319224610466, "entropy": 14.225474739074707, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 135200, "num_agent_steps_sampled": 135200, "num_steps_trained": 135200, "num_agent_steps_trained": 135200, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 150, "training_iteration": 13, "trial_id": "370a4_00000", "experiment_id": "1495134c1e64496d851df0205982c5a3", "date": "2024-01-04_10-06-59", "timestamp": 1704334019, "time_this_iter_s": 156.92098665237427, "time_total_s": 2023.38809299469, "pid": 13208, "hostname": "DESKTOP-CC49RT1", "node_ip": "127.0.0.1", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 10000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "aircombat", "env_args": {"map_name": "MultipleCombat_4v4/NoWeapon/vsBaseline"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": false, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 10, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box(-10.0, 10.0, (51,), float32))", "space_act": "MultiDiscrete([41 41 41 30])", "num_agents": 4, "episode_limit": 1000, "policy_mapping_info": {"MultipleCombat_2v2/NoWeapon/Selfplay": {"description": "aircombat AI vs AI", "team_prefix": ["teamA_", "teamB_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "MultipleCombat_2v2/NoWeapon/vsBaseline": {"description": "aircombat AI vs Bot", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "MultipleCombat_4v4/NoWeapon/vsBaseline": {"description": "aircombat AI vs Bot", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["agent_0", "agent_1", "agent_2", "agent_3"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "aircombat_MultipleCombat_4v4/NoWeapon/vsBaseline", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x000002124579FC10>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 10000, "shuffle_sequences": true, "num_sgd_iter": 5, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 2023.38809299469, "timesteps_since_restore": 0, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 22.917040358744394, "ram_util_percent": 48.24529147982063}}
{"episode_reward_max": 162.47328078988545, "episode_reward_min": -25.859143978006266, "episode_reward_mean": 69.19872334694863, "episode_len_mean": 227.55, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [90.54056328022779, 87.93347185112623, 38.3254180334949, 28.740362037006705, 97.63447138915137, 68.24296402837973, 27.045927589013417, 57.196051527351955, 70.17635300469652, 77.03287320039763, 26.932935113989046, -25.859143978006266, 113.81841671915544, 34.65326629400025, 98.55030413132255, 64.60699893249688, 74.56952112897568, 49.54010569184412, 61.61319764766326, 67.41499477544983, -24.350778835828287, 111.72151667021234, 11.797963401480695, 109.3565072579629, 134.03964095486248, 98.03771665808237, -17.964044401290664, 72.31115404789318, 103.55912794181052, 147.26064573767798, 62.78576567682303, 28.819381267236736, 71.73255479447559, 115.09005564686275, 52.43610193633195, 75.49855962503392, 96.93720560880743, 65.25096327920242, 45.734969816303334, 64.72774425662445, 100.34354864303211, 32.87730263914995, 103.86679194478938, 105.23633237899162, -21.31906944544958, 36.55446702130075, -24.12417735690823, 60.34700093717592, -20.30327219655075, 86.34418803495481, 43.15694067796696, 60.129381815089644, 61.35132584854006, 154.81736577500453, 80.4213487352368, 64.44588128595427, 85.30755005302782, 17.01634219639747, 80.63347202328379, 116.69136028401263, 132.4806731585321, 64.61468279842487, 38.28630718478934, 82.4014297183823, 70.70526555852231, 137.74104781899467, 95.18480373388508, 60.8790171649117, 52.82153180268786, 61.73451278829893, 127.78816726335084, 132.9165005509064, 81.35395997088926, 74.79875121476158, 64.05320647766364, -14.101706710639002, 79.1294612821901, 84.03898530392478, 62.785083426289475, 113.1794763055326, 82.56318419084494, 162.47328078988545, 102.40307418221354, 65.19580810931808, 21.285615378810483, 74.58759202444617, 56.111394737124556, 100.5395820603697, 71.17302924817403, 44.43136639329863, 65.85633659971819, 62.14665552621602, 62.690534964980145, 75.98816620690138, 117.49212127407313, 160.7939069459958, 2.0828196608588554, 74.39604041954576, 26.02503756015121, 31.559746576336593], "episode_lengths": [234, 254, 184, 305, 191, 174, 333, 228, 187, 246, 267, 341, 183, 333, 186, 186, 213, 210, 304, 241, 390, 211, 237, 271, 168, 179, 266, 200, 190, 187, 179, 224, 295, 167, 180, 155, 166, 173, 213, 204, 212, 229, 193, 244, 322, 207, 482, 218, 422, 245, 239, 259, 228, 172, 177, 277, 173, 305, 164, 170, 157, 197, 244, 176, 259, 163, 230, 241, 259, 184, 261, 173, 177, 200, 158, 292, 222, 197, 220, 201, 302, 155, 207, 227, 232, 253, 225, 188, 190, 197, 300, 210, 223, 178, 196, 163, 290, 225, 255, 335]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0589197545197542, "mean_inference_ms": 1.8529980014760117, "mean_action_processing_ms": 0.09076009820229668, "mean_env_wait_ms": 55.620587755609286, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 145600, "timesteps_this_iter": 0, "agent_timesteps_total": 145600, "timers": {"sample_time_ms": 155114.985, "sample_throughput": 67.047, "load_time_ms": 0.301, "load_throughput": 34600429.603, "learn_time_ms": 2649.753, "learn_throughput": 3924.894, "update_time_ms": 1.695}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 4.8828125e-05, "cur_lr": 0.0005, "total_loss": 158.60165100097657, "policy_loss": -0.0023969062604010105, "vf_loss": 158.74628601074218, "vf_explained_var": 0.49417545795440676, "kl": 0.002935070102234816, "entropy": 14.222204399108886, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 145600, "num_agent_steps_sampled": 145600, "num_steps_trained": 145600, "num_agent_steps_trained": 145600, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 160, "training_iteration": 14, "trial_id": "370a4_00000", "experiment_id": "1495134c1e64496d851df0205982c5a3", "date": "2024-01-04_10-09-34", "timestamp": 1704334174, "time_this_iter_s": 154.82088112831116, "time_total_s": 2178.208974123001, "pid": 13208, "hostname": "DESKTOP-CC49RT1", "node_ip": "127.0.0.1", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 10000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "aircombat", "env_args": {"map_name": "MultipleCombat_4v4/NoWeapon/vsBaseline"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": false, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 10, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box(-10.0, 10.0, (51,), float32))", "space_act": "MultiDiscrete([41 41 41 30])", "num_agents": 4, "episode_limit": 1000, "policy_mapping_info": {"MultipleCombat_2v2/NoWeapon/Selfplay": {"description": "aircombat AI vs AI", "team_prefix": ["teamA_", "teamB_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "MultipleCombat_2v2/NoWeapon/vsBaseline": {"description": "aircombat AI vs Bot", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "MultipleCombat_4v4/NoWeapon/vsBaseline": {"description": "aircombat AI vs Bot", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["agent_0", "agent_1", "agent_2", "agent_3"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "aircombat_MultipleCombat_4v4/NoWeapon/vsBaseline", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x000002124574C790>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 10000, "shuffle_sequences": true, "num_sgd_iter": 5, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 2178.208974123001, "timesteps_since_restore": 0, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 21.822831050228313, "ram_util_percent": 48.26666666666667}}
{"episode_reward_max": 221.43848654245988, "episode_reward_min": -42.038635169880635, "episode_reward_mean": 74.41171087913281, "episode_len_mean": 226.57, "episode_media": {}, "episodes_this_iter": 12, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [113.81841671915544, 34.65326629400025, 98.55030413132255, 64.60699893249688, 74.56952112897568, 49.54010569184412, 61.61319764766326, 67.41499477544983, -24.350778835828287, 111.72151667021234, 11.797963401480695, 109.3565072579629, 134.03964095486248, 98.03771665808237, -17.964044401290664, 72.31115404789318, 103.55912794181052, 147.26064573767798, 62.78576567682303, 28.819381267236736, 71.73255479447559, 115.09005564686275, 52.43610193633195, 75.49855962503392, 96.93720560880743, 65.25096327920242, 45.734969816303334, 64.72774425662445, 100.34354864303211, 32.87730263914995, 103.86679194478938, 105.23633237899162, -21.31906944544958, 36.55446702130075, -24.12417735690823, 60.34700093717592, -20.30327219655075, 86.34418803495481, 43.15694067796696, 60.129381815089644, 61.35132584854006, 154.81736577500453, 80.4213487352368, 64.44588128595427, 85.30755005302782, 17.01634219639747, 80.63347202328379, 116.69136028401263, 132.4806731585321, 64.61468279842487, 38.28630718478934, 82.4014297183823, 70.70526555852231, 137.74104781899467, 95.18480373388508, 60.8790171649117, 52.82153180268786, 61.73451278829893, 127.78816726335084, 132.9165005509064, 81.35395997088926, 74.79875121476158, 64.05320647766364, -14.101706710639002, 79.1294612821901, 84.03898530392478, 62.785083426289475, 113.1794763055326, 82.56318419084494, 162.47328078988545, 102.40307418221354, 65.19580810931808, 21.285615378810483, 74.58759202444617, 56.111394737124556, 100.5395820603697, 71.17302924817403, 44.43136639329863, 65.85633659971819, 62.14665552621602, 62.690534964980145, 75.98816620690138, 117.49212127407313, 160.7939069459958, 2.0828196608588554, 74.39604041954576, 26.02503756015121, 31.559746576336593, -42.038635169880635, 45.796788994565034, 187.94034582128552, 64.72713420303268, 221.43848654245988, 100.10789372670632, 91.15631462462233, 75.00832218190897, 32.38356911894908, 212.01436948646653, 122.06350197016246, 54.64290879496811], "episode_lengths": [183, 333, 186, 186, 213, 210, 304, 241, 390, 211, 237, 271, 168, 179, 266, 200, 190, 187, 179, 224, 295, 167, 180, 155, 166, 173, 213, 204, 212, 229, 193, 244, 322, 207, 482, 218, 422, 245, 239, 259, 228, 172, 177, 277, 173, 305, 164, 170, 157, 197, 244, 176, 259, 163, 230, 241, 259, 184, 261, 173, 177, 200, 158, 292, 222, 197, 220, 201, 302, 155, 207, 227, 232, 253, 225, 188, 190, 197, 300, 210, 223, 178, 196, 163, 290, 225, 255, 335, 394, 355, 169, 258, 145, 247, 188, 178, 334, 163, 196, 219]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0604642621572677, "mean_inference_ms": 1.8557646298806523, "mean_action_processing_ms": 0.09040999327269854, "mean_env_wait_ms": 55.66156815048168, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 156000, "timesteps_this_iter": 0, "agent_timesteps_total": 156000, "timers": {"sample_time_ms": 155809.35, "sample_throughput": 66.748, "load_time_ms": 0.205, "load_throughput": 50851902.075, "learn_time_ms": 2669.483, "learn_throughput": 3895.885, "update_time_ms": 1.896}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 2.44140625e-05, "cur_lr": 0.0005, "total_loss": 151.10597229003906, "policy_loss": 0.023634276539087295, "vf_loss": 151.2242858886719, "vf_explained_var": 0.531047773361206, "kl": 0.003213735727741307, "entropy": 14.19471778869629, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 156000, "num_agent_steps_sampled": 156000, "num_steps_trained": 156000, "num_agent_steps_trained": 156000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 172, "training_iteration": 15, "trial_id": "370a4_00000", "experiment_id": "1495134c1e64496d851df0205982c5a3", "date": "2024-01-04_10-12-08", "timestamp": 1704334328, "time_this_iter_s": 154.0605707168579, "time_total_s": 2332.269544839859, "pid": 13208, "hostname": "DESKTOP-CC49RT1", "node_ip": "127.0.0.1", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 10000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "aircombat", "env_args": {"map_name": "MultipleCombat_4v4/NoWeapon/vsBaseline"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": false, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 10, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box(-10.0, 10.0, (51,), float32))", "space_act": "MultiDiscrete([41 41 41 30])", "num_agents": 4, "episode_limit": 1000, "policy_mapping_info": {"MultipleCombat_2v2/NoWeapon/Selfplay": {"description": "aircombat AI vs AI", "team_prefix": ["teamA_", "teamB_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "MultipleCombat_2v2/NoWeapon/vsBaseline": {"description": "aircombat AI vs Bot", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "MultipleCombat_4v4/NoWeapon/vsBaseline": {"description": "aircombat AI vs Bot", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["agent_0", "agent_1", "agent_2", "agent_3"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "aircombat_MultipleCombat_4v4/NoWeapon/vsBaseline", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x00000212459DBE50>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 10000, "shuffle_sequences": true, "num_sgd_iter": 5, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 2332.269544839859, "timesteps_since_restore": 0, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 21.429816513761466, "ram_util_percent": 48.58211009174311}}
{"episode_reward_max": 221.43848654245988, "episode_reward_min": -42.038635169880635, "episode_reward_mean": 75.91459418057524, "episode_len_mean": 223.39, "episode_media": {}, "episodes_this_iter": 12, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [134.03964095486248, 98.03771665808237, -17.964044401290664, 72.31115404789318, 103.55912794181052, 147.26064573767798, 62.78576567682303, 28.819381267236736, 71.73255479447559, 115.09005564686275, 52.43610193633195, 75.49855962503392, 96.93720560880743, 65.25096327920242, 45.734969816303334, 64.72774425662445, 100.34354864303211, 32.87730263914995, 103.86679194478938, 105.23633237899162, -21.31906944544958, 36.55446702130075, -24.12417735690823, 60.34700093717592, -20.30327219655075, 86.34418803495481, 43.15694067796696, 60.129381815089644, 61.35132584854006, 154.81736577500453, 80.4213487352368, 64.44588128595427, 85.30755005302782, 17.01634219639747, 80.63347202328379, 116.69136028401263, 132.4806731585321, 64.61468279842487, 38.28630718478934, 82.4014297183823, 70.70526555852231, 137.74104781899467, 95.18480373388508, 60.8790171649117, 52.82153180268786, 61.73451278829893, 127.78816726335084, 132.9165005509064, 81.35395997088926, 74.79875121476158, 64.05320647766364, -14.101706710639002, 79.1294612821901, 84.03898530392478, 62.785083426289475, 113.1794763055326, 82.56318419084494, 162.47328078988545, 102.40307418221354, 65.19580810931808, 21.285615378810483, 74.58759202444617, 56.111394737124556, 100.5395820603697, 71.17302924817403, 44.43136639329863, 65.85633659971819, 62.14665552621602, 62.690534964980145, 75.98816620690138, 117.49212127407313, 160.7939069459958, 2.0828196608588554, 74.39604041954576, 26.02503756015121, 31.559746576336593, -42.038635169880635, 45.796788994565034, 187.94034582128552, 64.72713420303268, 221.43848654245988, 100.10789372670632, 91.15631462462233, 75.00832218190897, 32.38356911894908, 212.01436948646653, 122.06350197016246, 54.64290879496811, 78.34434478540089, 99.66492583026036, 4.556901489366927, 62.55737127869111, 85.12178782597744, 110.1410597857784, 58.91614396040532, 52.45186425296174, 95.58342129230732, 101.80883479168278, 90.38870309255921, 84.04498557358724], "episode_lengths": [168, 179, 266, 200, 190, 187, 179, 224, 295, 167, 180, 155, 166, 173, 213, 204, 212, 229, 193, 244, 322, 207, 482, 218, 422, 245, 239, 259, 228, 172, 177, 277, 173, 305, 164, 170, 157, 197, 244, 176, 259, 163, 230, 241, 259, 184, 261, 173, 177, 200, 158, 292, 222, 197, 220, 201, 302, 155, 207, 227, 232, 253, 225, 188, 190, 197, 300, 210, 223, 178, 196, 163, 290, 225, 255, 335, 394, 355, 169, 258, 145, 247, 188, 178, 334, 163, 196, 219, 174, 228, 455, 239, 214, 160, 219, 190, 153, 223, 190, 202]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0614196142250827, "mean_inference_ms": 1.858189978025988, "mean_action_processing_ms": 0.09016504309194592, "mean_env_wait_ms": 55.69722660570944, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 166400, "timesteps_this_iter": 0, "agent_timesteps_total": 166400, "timers": {"sample_time_ms": 156212.394, "sample_throughput": 66.576, "load_time_ms": 0.205, "load_throughput": 50851902.075, "learn_time_ms": 2667.798, "learn_throughput": 3898.345, "update_time_ms": 1.799}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.220703125e-05, "cur_lr": 0.0005, "total_loss": 149.93645324707032, "policy_loss": 0.007429471146315337, "vf_loss": 150.0706329345703, "vf_explained_var": 0.5521841168403625, "kl": 0.0039057233162353546, "entropy": 14.160222244262695, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 166400, "num_agent_steps_sampled": 166400, "num_steps_trained": 166400, "num_agent_steps_trained": 166400, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 184, "training_iteration": 16, "trial_id": "370a4_00000", "experiment_id": "1495134c1e64496d851df0205982c5a3", "date": "2024-01-04_10-14-44", "timestamp": 1704334484, "time_this_iter_s": 155.99246740341187, "time_total_s": 2488.262012243271, "pid": 13208, "hostname": "DESKTOP-CC49RT1", "node_ip": "127.0.0.1", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 10000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "aircombat", "env_args": {"map_name": "MultipleCombat_4v4/NoWeapon/vsBaseline"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": false, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 10, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box(-10.0, 10.0, (51,), float32))", "space_act": "MultiDiscrete([41 41 41 30])", "num_agents": 4, "episode_limit": 1000, "policy_mapping_info": {"MultipleCombat_2v2/NoWeapon/Selfplay": {"description": "aircombat AI vs AI", "team_prefix": ["teamA_", "teamB_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "MultipleCombat_2v2/NoWeapon/vsBaseline": {"description": "aircombat AI vs Bot", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "MultipleCombat_4v4/NoWeapon/vsBaseline": {"description": "aircombat AI vs Bot", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["agent_0", "agent_1", "agent_2", "agent_3"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "aircombat_MultipleCombat_4v4/NoWeapon/vsBaseline", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x00000212459B2C10>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 10000, "shuffle_sequences": true, "num_sgd_iter": 5, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 2488.262012243271, "timesteps_since_restore": 0, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 22.232126696832577, "ram_util_percent": 48.688687782805424}}
{"episode_reward_max": 221.43848654245988, "episode_reward_min": -42.038635169880635, "episode_reward_mean": 76.52592108942663, "episode_len_mean": 225.14, "episode_media": {}, "episodes_this_iter": 12, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [96.93720560880743, 65.25096327920242, 45.734969816303334, 64.72774425662445, 100.34354864303211, 32.87730263914995, 103.86679194478938, 105.23633237899162, -21.31906944544958, 36.55446702130075, -24.12417735690823, 60.34700093717592, -20.30327219655075, 86.34418803495481, 43.15694067796696, 60.129381815089644, 61.35132584854006, 154.81736577500453, 80.4213487352368, 64.44588128595427, 85.30755005302782, 17.01634219639747, 80.63347202328379, 116.69136028401263, 132.4806731585321, 64.61468279842487, 38.28630718478934, 82.4014297183823, 70.70526555852231, 137.74104781899467, 95.18480373388508, 60.8790171649117, 52.82153180268786, 61.73451278829893, 127.78816726335084, 132.9165005509064, 81.35395997088926, 74.79875121476158, 64.05320647766364, -14.101706710639002, 79.1294612821901, 84.03898530392478, 62.785083426289475, 113.1794763055326, 82.56318419084494, 162.47328078988545, 102.40307418221354, 65.19580810931808, 21.285615378810483, 74.58759202444617, 56.111394737124556, 100.5395820603697, 71.17302924817403, 44.43136639329863, 65.85633659971819, 62.14665552621602, 62.690534964980145, 75.98816620690138, 117.49212127407313, 160.7939069459958, 2.0828196608588554, 74.39604041954576, 26.02503756015121, 31.559746576336593, -42.038635169880635, 45.796788994565034, 187.94034582128552, 64.72713420303268, 221.43848654245988, 100.10789372670632, 91.15631462462233, 75.00832218190897, 32.38356911894908, 212.01436948646653, 122.06350197016246, 54.64290879496811, 78.34434478540089, 99.66492583026036, 4.556901489366927, 62.55737127869111, 85.12178782597744, 110.1410597857784, 58.91614396040532, 52.45186425296174, 95.58342129230732, 101.80883479168278, 90.38870309255921, 84.04498557358724, 133.67853260119432, 82.59687141290243, 116.3317323482089, 58.85104362160128, 129.8843701512767, 67.65313168397728, 87.0237096323514, 96.51799833050627, -27.70623585845163, 80.99301039901508, 88.05316377508275, 90.86202267327428], "episode_lengths": [166, 173, 213, 204, 212, 229, 193, 244, 322, 207, 482, 218, 422, 245, 239, 259, 228, 172, 177, 277, 173, 305, 164, 170, 157, 197, 244, 176, 259, 163, 230, 241, 259, 184, 261, 173, 177, 200, 158, 292, 222, 197, 220, 201, 302, 155, 207, 227, 232, 253, 225, 188, 190, 197, 300, 210, 223, 178, 196, 163, 290, 225, 255, 335, 394, 355, 169, 258, 145, 247, 188, 178, 334, 163, 196, 219, 174, 228, 455, 239, 214, 160, 219, 190, 153, 223, 190, 202, 191, 149, 219, 215, 177, 252, 265, 181, 286, 270, 182, 178]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0615595546539194, "mean_inference_ms": 1.8601297012363418, "mean_action_processing_ms": 0.09003871111507344, "mean_env_wait_ms": 55.73783166283852, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 176800, "timesteps_this_iter": 0, "agent_timesteps_total": 176800, "timers": {"sample_time_ms": 156474.513, "sample_throughput": 66.464, "load_time_ms": 0.102, "load_throughput": 101989155.015, "learn_time_ms": 2667.363, "learn_throughput": 3898.982, "update_time_ms": 1.799}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 6.103515625e-06, "cur_lr": 0.0005, "total_loss": 137.2260009765625, "policy_loss": 0.02446562945842743, "vf_loss": 137.34299926757814, "vf_explained_var": 0.5927412867546081, "kl": 0.0040345270624492, "entropy": 14.145877456665039, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 176800, "num_agent_steps_sampled": 176800, "num_steps_trained": 176800, "num_agent_steps_trained": 176800, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 196, "training_iteration": 17, "trial_id": "370a4_00000", "experiment_id": "1495134c1e64496d851df0205982c5a3", "date": "2024-01-04_10-17-23", "timestamp": 1704334643, "time_this_iter_s": 159.00453186035156, "time_total_s": 2647.2665441036224, "pid": 13208, "hostname": "DESKTOP-CC49RT1", "node_ip": "127.0.0.1", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 10000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "aircombat", "env_args": {"map_name": "MultipleCombat_4v4/NoWeapon/vsBaseline"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": false, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 10, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box(-10.0, 10.0, (51,), float32))", "space_act": "MultiDiscrete([41 41 41 30])", "num_agents": 4, "episode_limit": 1000, "policy_mapping_info": {"MultipleCombat_2v2/NoWeapon/Selfplay": {"description": "aircombat AI vs AI", "team_prefix": ["teamA_", "teamB_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "MultipleCombat_2v2/NoWeapon/vsBaseline": {"description": "aircombat AI vs Bot", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "MultipleCombat_4v4/NoWeapon/vsBaseline": {"description": "aircombat AI vs Bot", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["agent_0", "agent_1", "agent_2", "agent_3"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "aircombat_MultipleCombat_4v4/NoWeapon/vsBaseline", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x00000212457F4DC0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 10000, "shuffle_sequences": true, "num_sgd_iter": 5, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 2647.2665441036224, "timesteps_since_restore": 0, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 23.59555555555556, "ram_util_percent": 47.98533333333333}}
{"episode_reward_max": 221.43848654245988, "episode_reward_min": -42.038635169880635, "episode_reward_mean": 78.96126644966986, "episode_len_mean": 223.47, "episode_media": {}, "episodes_this_iter": 12, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-20.30327219655075, 86.34418803495481, 43.15694067796696, 60.129381815089644, 61.35132584854006, 154.81736577500453, 80.4213487352368, 64.44588128595427, 85.30755005302782, 17.01634219639747, 80.63347202328379, 116.69136028401263, 132.4806731585321, 64.61468279842487, 38.28630718478934, 82.4014297183823, 70.70526555852231, 137.74104781899467, 95.18480373388508, 60.8790171649117, 52.82153180268786, 61.73451278829893, 127.78816726335084, 132.9165005509064, 81.35395997088926, 74.79875121476158, 64.05320647766364, -14.101706710639002, 79.1294612821901, 84.03898530392478, 62.785083426289475, 113.1794763055326, 82.56318419084494, 162.47328078988545, 102.40307418221354, 65.19580810931808, 21.285615378810483, 74.58759202444617, 56.111394737124556, 100.5395820603697, 71.17302924817403, 44.43136639329863, 65.85633659971819, 62.14665552621602, 62.690534964980145, 75.98816620690138, 117.49212127407313, 160.7939069459958, 2.0828196608588554, 74.39604041954576, 26.02503756015121, 31.559746576336593, -42.038635169880635, 45.796788994565034, 187.94034582128552, 64.72713420303268, 221.43848654245988, 100.10789372670632, 91.15631462462233, 75.00832218190897, 32.38356911894908, 212.01436948646653, 122.06350197016246, 54.64290879496811, 78.34434478540089, 99.66492583026036, 4.556901489366927, 62.55737127869111, 85.12178782597744, 110.1410597857784, 58.91614396040532, 52.45186425296174, 95.58342129230732, 101.80883479168278, 90.38870309255921, 84.04498557358724, 133.67853260119432, 82.59687141290243, 116.3317323482089, 58.85104362160128, 129.8843701512767, 67.65313168397728, 87.0237096323514, 96.51799833050627, -27.70623585845163, 80.99301039901508, 88.05316377508275, 90.86202267327428, 131.78575968320888, 34.59918796436648, 84.4383575611131, 63.70061615693675, 84.42504032826187, 58.00032604301424, 69.82907715293982, 65.92394683686348, 137.10327952618275, 59.57117619308906, 104.76976529389646, 15.821083007469658], "episode_lengths": [422, 245, 239, 259, 228, 172, 177, 277, 173, 305, 164, 170, 157, 197, 244, 176, 259, 163, 230, 241, 259, 184, 261, 173, 177, 200, 158, 292, 222, 197, 220, 201, 302, 155, 207, 227, 232, 253, 225, 188, 190, 197, 300, 210, 223, 178, 196, 163, 290, 225, 255, 335, 394, 355, 169, 258, 145, 247, 188, 178, 334, 163, 196, 219, 174, 228, 455, 239, 214, 160, 219, 190, 153, 223, 190, 202, 191, 149, 219, 215, 177, 252, 265, 181, 286, 270, 182, 178, 189, 221, 222, 196, 184, 275, 225, 330, 170, 187, 162, 335]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0619447752521038, "mean_inference_ms": 1.8612660186337444, "mean_action_processing_ms": 0.08997386797080216, "mean_env_wait_ms": 55.76831815232224, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 187200, "timesteps_this_iter": 0, "agent_timesteps_total": 187200, "timers": {"sample_time_ms": 156943.201, "sample_throughput": 66.266, "load_time_ms": 0.102, "load_throughput": 101989155.015, "learn_time_ms": 2647.829, "learn_throughput": 3927.747, "update_time_ms": 1.602}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 3.0517578125e-06, "cur_lr": 0.0005, "total_loss": 150.20255432128906, "policy_loss": -0.023466502502560615, "vf_loss": 150.3673828125, "vf_explained_var": 0.5906822800636291, "kl": 0.0035786097657547144, "entropy": 14.136113166809082, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 187200, "num_agent_steps_sampled": 187200, "num_steps_trained": 187200, "num_agent_steps_trained": 187200, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 208, "training_iteration": 18, "trial_id": "370a4_00000", "experiment_id": "1495134c1e64496d851df0205982c5a3", "date": "2024-01-04_10-20-01", "timestamp": 1704334801, "time_this_iter_s": 158.08428978919983, "time_total_s": 2805.3508338928223, "pid": 13208, "hostname": "DESKTOP-CC49RT1", "node_ip": "127.0.0.1", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 10000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "aircombat", "env_args": {"map_name": "MultipleCombat_4v4/NoWeapon/vsBaseline"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": false, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 10, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box(-10.0, 10.0, (51,), float32))", "space_act": "MultiDiscrete([41 41 41 30])", "num_agents": 4, "episode_limit": 1000, "policy_mapping_info": {"MultipleCombat_2v2/NoWeapon/Selfplay": {"description": "aircombat AI vs AI", "team_prefix": ["teamA_", "teamB_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "MultipleCombat_2v2/NoWeapon/vsBaseline": {"description": "aircombat AI vs Bot", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "MultipleCombat_4v4/NoWeapon/vsBaseline": {"description": "aircombat AI vs Bot", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["agent_0", "agent_1", "agent_2", "agent_3"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "aircombat_MultipleCombat_4v4/NoWeapon/vsBaseline", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x000002124574C790>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 10000, "shuffle_sequences": true, "num_sgd_iter": 5, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 2805.3508338928223, "timesteps_since_restore": 0, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 22.81205357142857, "ram_util_percent": 49.127678571428575}}
{"episode_reward_max": 221.43848654245988, "episode_reward_min": -42.038635169880635, "episode_reward_mean": 80.95161033536118, "episode_len_mean": 220.9, "episode_media": {}, "episodes_this_iter": 11, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [116.69136028401263, 132.4806731585321, 64.61468279842487, 38.28630718478934, 82.4014297183823, 70.70526555852231, 137.74104781899467, 95.18480373388508, 60.8790171649117, 52.82153180268786, 61.73451278829893, 127.78816726335084, 132.9165005509064, 81.35395997088926, 74.79875121476158, 64.05320647766364, -14.101706710639002, 79.1294612821901, 84.03898530392478, 62.785083426289475, 113.1794763055326, 82.56318419084494, 162.47328078988545, 102.40307418221354, 65.19580810931808, 21.285615378810483, 74.58759202444617, 56.111394737124556, 100.5395820603697, 71.17302924817403, 44.43136639329863, 65.85633659971819, 62.14665552621602, 62.690534964980145, 75.98816620690138, 117.49212127407313, 160.7939069459958, 2.0828196608588554, 74.39604041954576, 26.02503756015121, 31.559746576336593, -42.038635169880635, 45.796788994565034, 187.94034582128552, 64.72713420303268, 221.43848654245988, 100.10789372670632, 91.15631462462233, 75.00832218190897, 32.38356911894908, 212.01436948646653, 122.06350197016246, 54.64290879496811, 78.34434478540089, 99.66492583026036, 4.556901489366927, 62.55737127869111, 85.12178782597744, 110.1410597857784, 58.91614396040532, 52.45186425296174, 95.58342129230732, 101.80883479168278, 90.38870309255921, 84.04498557358724, 133.67853260119432, 82.59687141290243, 116.3317323482089, 58.85104362160128, 129.8843701512767, 67.65313168397728, 87.0237096323514, 96.51799833050627, -27.70623585845163, 80.99301039901508, 88.05316377508275, 90.86202267327428, 131.78575968320888, 34.59918796436648, 84.4383575611131, 63.70061615693675, 84.42504032826187, 58.00032604301424, 69.82907715293982, 65.92394683686348, 137.10327952618275, 59.57117619308906, 104.76976529389646, 15.821083007469658, 125.3274915744077, 80.43463205826731, 88.18994834475271, 66.97938749528193, 24.824251281737414, 72.46748692136018, 79.076266483393, 72.42512603330688, 52.19925464698451, 125.25769064142463, 125.17337733712125], "episode_lengths": [170, 157, 197, 244, 176, 259, 163, 230, 241, 259, 184, 261, 173, 177, 200, 158, 292, 222, 197, 220, 201, 302, 155, 207, 227, 232, 253, 225, 188, 190, 197, 300, 210, 223, 178, 196, 163, 290, 225, 255, 335, 394, 355, 169, 258, 145, 247, 188, 178, 334, 163, 196, 219, 174, 228, 455, 239, 214, 160, 219, 190, 153, 223, 190, 202, 191, 149, 219, 215, 177, 252, 265, 181, 286, 270, 182, 178, 189, 221, 222, 196, 184, 275, 225, 330, 170, 187, 162, 335, 188, 221, 172, 189, 194, 203, 346, 261, 276, 164, 190]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.062107986878861, "mean_inference_ms": 1.8618648011371193, "mean_action_processing_ms": 0.08989679864584567, "mean_env_wait_ms": 55.801851485695444, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 197600, "timesteps_this_iter": 0, "agent_timesteps_total": 197600, "timers": {"sample_time_ms": 156727.081, "sample_throughput": 66.357, "load_time_ms": 0.202, "load_throughput": 51542906.298, "learn_time_ms": 2622.053, "learn_throughput": 3966.358, "update_time_ms": 1.5}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.52587890625e-06, "cur_lr": 0.0005, "total_loss": 141.92515869140624, "policy_loss": -0.014127321913838387, "vf_loss": 142.08059692382812, "vf_explained_var": 0.6059363722801209, "kl": 0.004621634363316196, "entropy": 14.131239700317384, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 197600, "num_agent_steps_sampled": 197600, "num_steps_trained": 197600, "num_agent_steps_trained": 197600, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 219, "training_iteration": 19, "trial_id": "370a4_00000", "experiment_id": "1495134c1e64496d851df0205982c5a3", "date": "2024-01-04_10-22-40", "timestamp": 1704334960, "time_this_iter_s": 158.67508363723755, "time_total_s": 2964.02591753006, "pid": 13208, "hostname": "DESKTOP-CC49RT1", "node_ip": "127.0.0.1", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 10000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "aircombat", "env_args": {"map_name": "MultipleCombat_4v4/NoWeapon/vsBaseline"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": false, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 10, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box(-10.0, 10.0, (51,), float32))", "space_act": "MultiDiscrete([41 41 41 30])", "num_agents": 4, "episode_limit": 1000, "policy_mapping_info": {"MultipleCombat_2v2/NoWeapon/Selfplay": {"description": "aircombat AI vs AI", "team_prefix": ["teamA_", "teamB_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "MultipleCombat_2v2/NoWeapon/vsBaseline": {"description": "aircombat AI vs Bot", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "MultipleCombat_4v4/NoWeapon/vsBaseline": {"description": "aircombat AI vs Bot", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["agent_0", "agent_1", "agent_2", "agent_3"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "aircombat_MultipleCombat_4v4/NoWeapon/vsBaseline", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x00000212459B2790>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 10000, "shuffle_sequences": true, "num_sgd_iter": 5, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 2964.02591753006, "timesteps_since_restore": 0, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 23.349777777777778, "ram_util_percent": 50.27466666666667}}
{"episode_reward_max": 221.43848654245988, "episode_reward_min": -42.038635169880635, "episode_reward_mean": 79.48153723686015, "episode_len_mean": 225.05, "episode_media": {}, "episodes_this_iter": 11, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [127.78816726335084, 132.9165005509064, 81.35395997088926, 74.79875121476158, 64.05320647766364, -14.101706710639002, 79.1294612821901, 84.03898530392478, 62.785083426289475, 113.1794763055326, 82.56318419084494, 162.47328078988545, 102.40307418221354, 65.19580810931808, 21.285615378810483, 74.58759202444617, 56.111394737124556, 100.5395820603697, 71.17302924817403, 44.43136639329863, 65.85633659971819, 62.14665552621602, 62.690534964980145, 75.98816620690138, 117.49212127407313, 160.7939069459958, 2.0828196608588554, 74.39604041954576, 26.02503756015121, 31.559746576336593, -42.038635169880635, 45.796788994565034, 187.94034582128552, 64.72713420303268, 221.43848654245988, 100.10789372670632, 91.15631462462233, 75.00832218190897, 32.38356911894908, 212.01436948646653, 122.06350197016246, 54.64290879496811, 78.34434478540089, 99.66492583026036, 4.556901489366927, 62.55737127869111, 85.12178782597744, 110.1410597857784, 58.91614396040532, 52.45186425296174, 95.58342129230732, 101.80883479168278, 90.38870309255921, 84.04498557358724, 133.67853260119432, 82.59687141290243, 116.3317323482089, 58.85104362160128, 129.8843701512767, 67.65313168397728, 87.0237096323514, 96.51799833050627, -27.70623585845163, 80.99301039901508, 88.05316377508275, 90.86202267327428, 131.78575968320888, 34.59918796436648, 84.4383575611131, 63.70061615693675, 84.42504032826187, 58.00032604301424, 69.82907715293982, 65.92394683686348, 137.10327952618275, 59.57117619308906, 104.76976529389646, 15.821083007469658, 125.3274915744077, 80.43463205826731, 88.18994834475271, 66.97938749528193, 24.824251281737414, 72.46748692136018, 79.076266483393, 72.42512603330688, 52.19925464698451, 125.25769064142463, 125.17337733712125, 13.843015976144837, 131.35317710977893, 21.250522875498177, 21.808219670388162, 37.05499603587485, 49.60766061565958, 61.78835515960952, 73.43176251065825, 138.86212662414272, 161.536519921764, 55.99696566182064], "episode_lengths": [261, 173, 177, 200, 158, 292, 222, 197, 220, 201, 302, 155, 207, 227, 232, 253, 225, 188, 190, 197, 300, 210, 223, 178, 196, 163, 290, 225, 255, 335, 394, 355, 169, 258, 145, 247, 188, 178, 334, 163, 196, 219, 174, 228, 455, 239, 214, 160, 219, 190, 153, 223, 190, 202, 191, 149, 219, 215, 177, 252, 265, 181, 286, 270, 182, 178, 189, 221, 222, 196, 184, 275, 225, 330, 170, 187, 162, 335, 188, 221, 172, 189, 194, 203, 346, 261, 276, 164, 190, 287, 208, 345, 364, 269, 259, 171, 177, 218, 190, 207]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.061753063847342, "mean_inference_ms": 1.8623829374450367, "mean_action_processing_ms": 0.08985713032500103, "mean_env_wait_ms": 55.824525348677795, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 208000, "timesteps_this_iter": 0, "agent_timesteps_total": 208000, "timers": {"sample_time_ms": 156968.627, "sample_throughput": 66.255, "load_time_ms": 0.1, "load_throughput": 104206310.559, "learn_time_ms": 2630.905, "learn_throughput": 3953.012, "update_time_ms": 1.404}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 7.62939453125e-07, "cur_lr": 0.0005, "total_loss": 123.69241180419922, "policy_loss": 0.015560698974877597, "vf_loss": 123.81869812011719, "vf_explained_var": 0.6411595821380616, "kl": 0.0033709230742535513, "entropy": 14.18419189453125, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 208000, "num_agent_steps_sampled": 208000, "num_steps_trained": 208000, "num_agent_steps_trained": 208000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 230, "training_iteration": 20, "trial_id": "370a4_00000", "experiment_id": "1495134c1e64496d851df0205982c5a3", "date": "2024-01-04_10-25-16", "timestamp": 1704335116, "time_this_iter_s": 155.3166241645813, "time_total_s": 3119.342541694641, "pid": 13208, "hostname": "DESKTOP-CC49RT1", "node_ip": "127.0.0.1", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 10000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "aircombat", "env_args": {"map_name": "MultipleCombat_4v4/NoWeapon/vsBaseline"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": false, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 10, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box(-10.0, 10.0, (51,), float32))", "space_act": "MultiDiscrete([41 41 41 30])", "num_agents": 4, "episode_limit": 1000, "policy_mapping_info": {"MultipleCombat_2v2/NoWeapon/Selfplay": {"description": "aircombat AI vs AI", "team_prefix": ["teamA_", "teamB_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "MultipleCombat_2v2/NoWeapon/vsBaseline": {"description": "aircombat AI vs Bot", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "MultipleCombat_4v4/NoWeapon/vsBaseline": {"description": "aircombat AI vs Bot", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["agent_0", "agent_1", "agent_2", "agent_3"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "aircombat_MultipleCombat_4v4/NoWeapon/vsBaseline", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x00000212459BF5E0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 10000, "shuffle_sequences": true, "num_sgd_iter": 5, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 3119.342541694641, "timesteps_since_restore": 0, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 25.53136363636364, "ram_util_percent": 51.14954545454545}}
{"episode_reward_max": 221.43848654245988, "episode_reward_min": -42.038635169880635, "episode_reward_mean": 79.35068378689421, "episode_len_mean": 223.89, "episode_media": {}, "episodes_this_iter": 13, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [65.19580810931808, 21.285615378810483, 74.58759202444617, 56.111394737124556, 100.5395820603697, 71.17302924817403, 44.43136639329863, 65.85633659971819, 62.14665552621602, 62.690534964980145, 75.98816620690138, 117.49212127407313, 160.7939069459958, 2.0828196608588554, 74.39604041954576, 26.02503756015121, 31.559746576336593, -42.038635169880635, 45.796788994565034, 187.94034582128552, 64.72713420303268, 221.43848654245988, 100.10789372670632, 91.15631462462233, 75.00832218190897, 32.38356911894908, 212.01436948646653, 122.06350197016246, 54.64290879496811, 78.34434478540089, 99.66492583026036, 4.556901489366927, 62.55737127869111, 85.12178782597744, 110.1410597857784, 58.91614396040532, 52.45186425296174, 95.58342129230732, 101.80883479168278, 90.38870309255921, 84.04498557358724, 133.67853260119432, 82.59687141290243, 116.3317323482089, 58.85104362160128, 129.8843701512767, 67.65313168397728, 87.0237096323514, 96.51799833050627, -27.70623585845163, 80.99301039901508, 88.05316377508275, 90.86202267327428, 131.78575968320888, 34.59918796436648, 84.4383575611131, 63.70061615693675, 84.42504032826187, 58.00032604301424, 69.82907715293982, 65.92394683686348, 137.10327952618275, 59.57117619308906, 104.76976529389646, 15.821083007469658, 125.3274915744077, 80.43463205826731, 88.18994834475271, 66.97938749528193, 24.824251281737414, 72.46748692136018, 79.076266483393, 72.42512603330688, 52.19925464698451, 125.25769064142463, 125.17337733712125, 13.843015976144837, 131.35317710977893, 21.250522875498177, 21.808219670388162, 37.05499603587485, 49.60766061565958, 61.78835515960952, 73.43176251065825, 138.86212662414272, 161.536519921764, 55.99696566182064, 75.82729058721117, 68.29793254958535, 122.99178357624606, 91.7627686049355, 91.55942576577661, 150.5568955088118, 82.74726580309681, 86.0025190280504, 68.35351418038842, 45.297074958257014, 91.21608146033398, 81.142293330397, 84.54123389812929], "episode_lengths": [227, 232, 253, 225, 188, 190, 197, 300, 210, 223, 178, 196, 163, 290, 225, 255, 335, 394, 355, 169, 258, 145, 247, 188, 178, 334, 163, 196, 219, 174, 228, 455, 239, 214, 160, 219, 190, 153, 223, 190, 202, 191, 149, 219, 215, 177, 252, 265, 181, 286, 270, 182, 178, 189, 221, 222, 196, 184, 275, 225, 330, 170, 187, 162, 335, 188, 221, 172, 189, 194, 203, 346, 261, 276, 164, 190, 287, 208, 345, 364, 269, 259, 171, 177, 218, 190, 207, 186, 217, 184, 190, 184, 199, 288, 183, 215, 207, 186, 183, 227]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0617357475122475, "mean_inference_ms": 1.8630320926731339, "mean_action_processing_ms": 0.08980297631648622, "mean_env_wait_ms": 55.853575701808204, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 218400, "timesteps_this_iter": 0, "agent_timesteps_total": 218400, "timers": {"sample_time_ms": 157025.171, "sample_throughput": 66.231, "load_time_ms": 0.1, "load_throughput": 104206310.559, "learn_time_ms": 2595.117, "learn_throughput": 4007.527, "update_time_ms": 1.501}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 3.814697265625e-07, "cur_lr": 0.0005, "total_loss": 134.05386352539062, "policy_loss": 0.0017621960956603288, "vf_loss": 134.19347229003907, "vf_explained_var": 0.655875849723816, "kl": 0.0033786391747946177, "entropy": 14.13756275177002, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 218400, "num_agent_steps_sampled": 218400, "num_steps_trained": 218400, "num_agent_steps_trained": 218400, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 243, "training_iteration": 21, "trial_id": "370a4_00000", "experiment_id": "1495134c1e64496d851df0205982c5a3", "date": "2024-01-04_10-27-55", "timestamp": 1704335275, "time_this_iter_s": 159.701730966568, "time_total_s": 3279.044272661209, "pid": 13208, "hostname": "DESKTOP-CC49RT1", "node_ip": "127.0.0.1", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 10000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "aircombat", "env_args": {"map_name": "MultipleCombat_4v4/NoWeapon/vsBaseline"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": false, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 10, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box(-10.0, 10.0, (51,), float32))", "space_act": "MultiDiscrete([41 41 41 30])", "num_agents": 4, "episode_limit": 1000, "policy_mapping_info": {"MultipleCombat_2v2/NoWeapon/Selfplay": {"description": "aircombat AI vs AI", "team_prefix": ["teamA_", "teamB_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "MultipleCombat_2v2/NoWeapon/vsBaseline": {"description": "aircombat AI vs Bot", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "MultipleCombat_4v4/NoWeapon/vsBaseline": {"description": "aircombat AI vs Bot", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["agent_0", "agent_1", "agent_2", "agent_3"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "aircombat_MultipleCombat_4v4/NoWeapon/vsBaseline", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x00000212459BF0D0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 10000, "shuffle_sequences": true, "num_sgd_iter": 5, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 3279.044272661209, "timesteps_since_restore": 0, "iterations_since_restore": 21, "perf": {"cpu_util_percent": 23.801769911504422, "ram_util_percent": 49.81991150442477}}
{"episode_reward_max": 221.43848654245988, "episode_reward_min": -42.038635169880635, "episode_reward_mean": 82.04420860210688, "episode_len_mean": 223.41, "episode_media": {}, "episodes_this_iter": 11, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [117.49212127407313, 160.7939069459958, 2.0828196608588554, 74.39604041954576, 26.02503756015121, 31.559746576336593, -42.038635169880635, 45.796788994565034, 187.94034582128552, 64.72713420303268, 221.43848654245988, 100.10789372670632, 91.15631462462233, 75.00832218190897, 32.38356911894908, 212.01436948646653, 122.06350197016246, 54.64290879496811, 78.34434478540089, 99.66492583026036, 4.556901489366927, 62.55737127869111, 85.12178782597744, 110.1410597857784, 58.91614396040532, 52.45186425296174, 95.58342129230732, 101.80883479168278, 90.38870309255921, 84.04498557358724, 133.67853260119432, 82.59687141290243, 116.3317323482089, 58.85104362160128, 129.8843701512767, 67.65313168397728, 87.0237096323514, 96.51799833050627, -27.70623585845163, 80.99301039901508, 88.05316377508275, 90.86202267327428, 131.78575968320888, 34.59918796436648, 84.4383575611131, 63.70061615693675, 84.42504032826187, 58.00032604301424, 69.82907715293982, 65.92394683686348, 137.10327952618275, 59.57117619308906, 104.76976529389646, 15.821083007469658, 125.3274915744077, 80.43463205826731, 88.18994834475271, 66.97938749528193, 24.824251281737414, 72.46748692136018, 79.076266483393, 72.42512603330688, 52.19925464698451, 125.25769064142463, 125.17337733712125, 13.843015976144837, 131.35317710977893, 21.250522875498177, 21.808219670388162, 37.05499603587485, 49.60766061565958, 61.78835515960952, 73.43176251065825, 138.86212662414272, 161.536519921764, 55.99696566182064, 75.82729058721117, 68.29793254958535, 122.99178357624606, 91.7627686049355, 91.55942576577661, 150.5568955088118, 82.74726580309681, 86.0025190280504, 68.35351418038842, 45.297074958257014, 91.21608146033398, 81.142293330397, 84.54123389812929, 75.99917501363072, -10.914498604792875, 195.0270359469742, 119.74391962773694, 20.554584316719243, 79.76926699034577, 59.81202371678981, 74.47812017884183, 198.58553947892466, 74.22789845197815, 82.07549765347449], "episode_lengths": [196, 163, 290, 225, 255, 335, 394, 355, 169, 258, 145, 247, 188, 178, 334, 163, 196, 219, 174, 228, 455, 239, 214, 160, 219, 190, 153, 223, 190, 202, 191, 149, 219, 215, 177, 252, 265, 181, 286, 270, 182, 178, 189, 221, 222, 196, 184, 275, 225, 330, 170, 187, 162, 335, 188, 221, 172, 189, 194, 203, 346, 261, 276, 164, 190, 287, 208, 345, 364, 269, 259, 171, 177, 218, 190, 207, 186, 217, 184, 190, 184, 199, 288, 183, 215, 207, 186, 183, 227, 212, 329, 189, 188, 288, 177, 242, 162, 171, 215, 202]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0613706911808414, "mean_inference_ms": 1.863199531238074, "mean_action_processing_ms": 0.08971440538449152, "mean_env_wait_ms": 55.86759409626877, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 228800, "timesteps_this_iter": 0, "agent_timesteps_total": 228800, "timers": {"sample_time_ms": 156395.58, "sample_throughput": 66.498, "load_time_ms": 0.1, "load_throughput": 104206310.559, "learn_time_ms": 2592.14, "learn_throughput": 4012.128, "update_time_ms": 1.686}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.9073486328125e-07, "cur_lr": 0.0005, "total_loss": 132.61961669921874, "policy_loss": -0.021233832463622093, "vf_loss": 132.7820251464844, "vf_explained_var": 0.6449820637702942, "kl": 0.0030027015005058997, "entropy": 14.116937065124512, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 228800, "num_agent_steps_sampled": 228800, "num_steps_trained": 228800, "num_agent_steps_trained": 228800, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 254, "training_iteration": 22, "trial_id": "370a4_00000", "experiment_id": "1495134c1e64496d851df0205982c5a3", "date": "2024-01-04_10-30-26", "timestamp": 1704335426, "time_this_iter_s": 151.0020031929016, "time_total_s": 3430.0462758541107, "pid": 13208, "hostname": "DESKTOP-CC49RT1", "node_ip": "127.0.0.1", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 10000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "aircombat", "env_args": {"map_name": "MultipleCombat_4v4/NoWeapon/vsBaseline"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": false, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 10, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box(-10.0, 10.0, (51,), float32))", "space_act": "MultiDiscrete([41 41 41 30])", "num_agents": 4, "episode_limit": 1000, "policy_mapping_info": {"MultipleCombat_2v2/NoWeapon/Selfplay": {"description": "aircombat AI vs AI", "team_prefix": ["teamA_", "teamB_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "MultipleCombat_2v2/NoWeapon/vsBaseline": {"description": "aircombat AI vs Bot", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "MultipleCombat_4v4/NoWeapon/vsBaseline": {"description": "aircombat AI vs Bot", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["agent_0", "agent_1", "agent_2", "agent_3"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "aircombat_MultipleCombat_4v4/NoWeapon/vsBaseline", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x00000212459DC8B0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 10000, "shuffle_sequences": true, "num_sgd_iter": 5, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 3430.0462758541107, "timesteps_since_restore": 0, "iterations_since_restore": 22, "perf": {"cpu_util_percent": 18.932710280373833, "ram_util_percent": 49.22710280373831}}
{"episode_reward_max": 212.01436948646653, "episode_reward_min": -27.70623585845163, "episode_reward_mean": 81.36908832129465, "episode_len_mean": 219.95, "episode_media": {}, "episodes_this_iter": 12, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [91.15631462462233, 75.00832218190897, 32.38356911894908, 212.01436948646653, 122.06350197016246, 54.64290879496811, 78.34434478540089, 99.66492583026036, 4.556901489366927, 62.55737127869111, 85.12178782597744, 110.1410597857784, 58.91614396040532, 52.45186425296174, 95.58342129230732, 101.80883479168278, 90.38870309255921, 84.04498557358724, 133.67853260119432, 82.59687141290243, 116.3317323482089, 58.85104362160128, 129.8843701512767, 67.65313168397728, 87.0237096323514, 96.51799833050627, -27.70623585845163, 80.99301039901508, 88.05316377508275, 90.86202267327428, 131.78575968320888, 34.59918796436648, 84.4383575611131, 63.70061615693675, 84.42504032826187, 58.00032604301424, 69.82907715293982, 65.92394683686348, 137.10327952618275, 59.57117619308906, 104.76976529389646, 15.821083007469658, 125.3274915744077, 80.43463205826731, 88.18994834475271, 66.97938749528193, 24.824251281737414, 72.46748692136018, 79.076266483393, 72.42512603330688, 52.19925464698451, 125.25769064142463, 125.17337733712125, 13.843015976144837, 131.35317710977893, 21.250522875498177, 21.808219670388162, 37.05499603587485, 49.60766061565958, 61.78835515960952, 73.43176251065825, 138.86212662414272, 161.536519921764, 55.99696566182064, 75.82729058721117, 68.29793254958535, 122.99178357624606, 91.7627686049355, 91.55942576577661, 150.5568955088118, 82.74726580309681, 86.0025190280504, 68.35351418038842, 45.297074958257014, 91.21608146033398, 81.142293330397, 84.54123389812929, 75.99917501363072, -10.914498604792875, 195.0270359469742, 119.74391962773694, 20.554584316719243, 79.76926699034577, 59.81202371678981, 74.47812017884183, 198.58553947892466, 74.22789845197815, 82.07549765347449, 66.27995930695496, 69.41933087774464, 85.99253556545733, 65.51982656596891, 85.43616690076249, 27.964523090087212, 94.7314535373752, 69.95154566415364, 76.55284766339815, 123.95140976759996, 86.51516402956454, 70.49489550484077], "episode_lengths": [188, 178, 334, 163, 196, 219, 174, 228, 455, 239, 214, 160, 219, 190, 153, 223, 190, 202, 191, 149, 219, 215, 177, 252, 265, 181, 286, 270, 182, 178, 189, 221, 222, 196, 184, 275, 225, 330, 170, 187, 162, 335, 188, 221, 172, 189, 194, 203, 346, 261, 276, 164, 190, 287, 208, 345, 364, 269, 259, 171, 177, 218, 190, 207, 186, 217, 184, 190, 184, 199, 288, 183, 215, 207, 186, 183, 227, 212, 329, 189, 188, 288, 177, 242, 162, 171, 215, 202, 417, 186, 219, 164, 177, 243, 219, 199, 200, 228, 216, 218]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0614073696766801, "mean_inference_ms": 1.8630073715692907, "mean_action_processing_ms": 0.08959151200428528, "mean_env_wait_ms": 55.89094319749389, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 239200, "timesteps_this_iter": 0, "agent_timesteps_total": 239200, "timers": {"sample_time_ms": 156493.036, "sample_throughput": 66.457, "load_time_ms": 0.1, "load_throughput": 104206310.559, "learn_time_ms": 2586.52, "learn_throughput": 4020.847, "update_time_ms": 1.689}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 9.5367431640625e-08, "cur_lr": 0.0005, "total_loss": 122.98676452636718, "policy_loss": -0.03253579586744308, "vf_loss": 123.15999145507813, "vf_explained_var": 0.6703727841377258, "kl": 0.00517660425099199, "entropy": 14.068992424011231, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 239200, "num_agent_steps_sampled": 239200, "num_steps_trained": 239200, "num_agent_steps_trained": 239200, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 266, "training_iteration": 23, "trial_id": "370a4_00000", "experiment_id": "1495134c1e64496d851df0205982c5a3", "date": "2024-01-04_10-33-04", "timestamp": 1704335584, "time_this_iter_s": 157.8653256893158, "time_total_s": 3587.9116015434265, "pid": 13208, "hostname": "DESKTOP-CC49RT1", "node_ip": "127.0.0.1", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 10000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "aircombat", "env_args": {"map_name": "MultipleCombat_4v4/NoWeapon/vsBaseline"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": false, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 10, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box(-10.0, 10.0, (51,), float32))", "space_act": "MultiDiscrete([41 41 41 30])", "num_agents": 4, "episode_limit": 1000, "policy_mapping_info": {"MultipleCombat_2v2/NoWeapon/Selfplay": {"description": "aircombat AI vs AI", "team_prefix": ["teamA_", "teamB_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "MultipleCombat_2v2/NoWeapon/vsBaseline": {"description": "aircombat AI vs Bot", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "MultipleCombat_4v4/NoWeapon/vsBaseline": {"description": "aircombat AI vs Bot", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["agent_0", "agent_1", "agent_2", "agent_3"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "aircombat_MultipleCombat_4v4/NoWeapon/vsBaseline", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x000002124579FC10>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 10000, "shuffle_sequences": true, "num_sgd_iter": 5, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 3587.9116015434265, "timesteps_since_restore": 0, "iterations_since_restore": 23, "perf": {"cpu_util_percent": 33.58878923766815, "ram_util_percent": 49.630044843049326}}
{"episode_reward_max": 198.58553947892466, "episode_reward_min": -27.70623585845163, "episode_reward_mean": 79.69490725822384, "episode_len_mean": 219.75, "episode_media": {}, "episodes_this_iter": 12, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [58.91614396040532, 52.45186425296174, 95.58342129230732, 101.80883479168278, 90.38870309255921, 84.04498557358724, 133.67853260119432, 82.59687141290243, 116.3317323482089, 58.85104362160128, 129.8843701512767, 67.65313168397728, 87.0237096323514, 96.51799833050627, -27.70623585845163, 80.99301039901508, 88.05316377508275, 90.86202267327428, 131.78575968320888, 34.59918796436648, 84.4383575611131, 63.70061615693675, 84.42504032826187, 58.00032604301424, 69.82907715293982, 65.92394683686348, 137.10327952618275, 59.57117619308906, 104.76976529389646, 15.821083007469658, 125.3274915744077, 80.43463205826731, 88.18994834475271, 66.97938749528193, 24.824251281737414, 72.46748692136018, 79.076266483393, 72.42512603330688, 52.19925464698451, 125.25769064142463, 125.17337733712125, 13.843015976144837, 131.35317710977893, 21.250522875498177, 21.808219670388162, 37.05499603587485, 49.60766061565958, 61.78835515960952, 73.43176251065825, 138.86212662414272, 161.536519921764, 55.99696566182064, 75.82729058721117, 68.29793254958535, 122.99178357624606, 91.7627686049355, 91.55942576577661, 150.5568955088118, 82.74726580309681, 86.0025190280504, 68.35351418038842, 45.297074958257014, 91.21608146033398, 81.142293330397, 84.54123389812929, 75.99917501363072, -10.914498604792875, 195.0270359469742, 119.74391962773694, 20.554584316719243, 79.76926699034577, 59.81202371678981, 74.47812017884183, 198.58553947892466, 74.22789845197815, 82.07549765347449, 66.27995930695496, 69.41933087774464, 85.99253556545733, 65.51982656596891, 85.43616690076249, 27.964523090087212, 94.7314535373752, 69.95154566415364, 76.55284766339815, 123.95140976759996, 86.51516402956454, 70.49489550484077, 79.47551984191301, 43.40394479162789, 35.985037479751014, 32.6534543072092, 97.18381567204995, 155.86058718271147, 116.52958814338999, 53.81393317111585, 68.93895950008442, 51.98758936998891, 51.94079425406753, 72.46404715156069], "episode_lengths": [219, 190, 153, 223, 190, 202, 191, 149, 219, 215, 177, 252, 265, 181, 286, 270, 182, 178, 189, 221, 222, 196, 184, 275, 225, 330, 170, 187, 162, 335, 188, 221, 172, 189, 194, 203, 346, 261, 276, 164, 190, 287, 208, 345, 364, 269, 259, 171, 177, 218, 190, 207, 186, 217, 184, 190, 184, 199, 288, 183, 215, 207, 186, 183, 227, 212, 329, 189, 188, 288, 177, 242, 162, 171, 215, 202, 417, 186, 219, 164, 177, 243, 219, 199, 200, 228, 216, 218, 216, 313, 401, 185, 190, 132, 165, 260, 184, 227, 222, 233]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0613296905083935, "mean_inference_ms": 1.8625190915612548, "mean_action_processing_ms": 0.08945276517273544, "mean_env_wait_ms": 55.912778846896096, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 249600, "timesteps_this_iter": 0, "agent_timesteps_total": 249600, "timers": {"sample_time_ms": 156439.967, "sample_throughput": 66.479, "load_time_ms": 0.1, "load_throughput": 104206310.559, "learn_time_ms": 2578.945, "learn_throughput": 4032.657, "update_time_ms": 1.689}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 9.5367431640625e-08, "cur_lr": 0.0005, "total_loss": 127.82643432617188, "policy_loss": 0.010972590767778456, "vf_loss": 127.95600738525391, "vf_explained_var": 0.6417875289916992, "kl": 0.003705424118513501, "entropy": 14.054687118530273, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 249600, "num_agent_steps_sampled": 249600, "num_steps_trained": 249600, "num_agent_steps_trained": 249600, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 278, "training_iteration": 24, "trial_id": "370a4_00000", "experiment_id": "1495134c1e64496d851df0205982c5a3", "date": "2024-01-04_10-35-39", "timestamp": 1704335739, "time_this_iter_s": 154.27104115486145, "time_total_s": 3742.182642698288, "pid": 13208, "hostname": "DESKTOP-CC49RT1", "node_ip": "127.0.0.1", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 10000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "aircombat", "env_args": {"map_name": "MultipleCombat_4v4/NoWeapon/vsBaseline"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": false, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 10, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box(-10.0, 10.0, (51,), float32))", "space_act": "MultiDiscrete([41 41 41 30])", "num_agents": 4, "episode_limit": 1000, "policy_mapping_info": {"MultipleCombat_2v2/NoWeapon/Selfplay": {"description": "aircombat AI vs AI", "team_prefix": ["teamA_", "teamB_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "MultipleCombat_2v2/NoWeapon/vsBaseline": {"description": "aircombat AI vs Bot", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "MultipleCombat_4v4/NoWeapon/vsBaseline": {"description": "aircombat AI vs Bot", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["agent_0", "agent_1", "agent_2", "agent_3"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "aircombat_MultipleCombat_4v4/NoWeapon/vsBaseline", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x00000212459B2CA0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 10000, "shuffle_sequences": true, "num_sgd_iter": 5, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 3742.182642698288, "timesteps_since_restore": 0, "iterations_since_restore": 24, "perf": {"cpu_util_percent": 35.239269406392694, "ram_util_percent": 48.460273972602735}}
